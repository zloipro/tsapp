(this.webpackJsonptsapp=this.webpackJsonptsapp||[]).push([[0],{363:function(e,t,n){},413:function(e,t){},415:function(e,t,n){},489:function(e,t,n){},490:function(e,t,n){},545:function(e,t,n){},546:function(e,t,n){},547:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(76),s=n.n(c),i=(n(363),n(9)),o=n(15),l=n(23),d=n.n(l),u=n(34),j=n.n(u),p=n(25),b=n.n(p),h=n(62),m=n(343),O=n(53),x=n(601),f=n(286),g=n(108),v=n(604),y=n(600),C=n(553),k=n(287),S=n(338),w=n.n(S),F=n(596),N=n(2),I="YYYY-MM-DD";function D(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=d()(e,t);return 0!==n?n.toFixed(t):Object(N.jsxs)("span",{style:{opacity:"0.6"},children:["0",t>0?".":"",w()("0",t)]})}function _(e){var t=e.prop,n=e.title,a=e.collapsing,r=e.style,c=e.sort,s=e.onSort;return Object(N.jsx)(F.a.HeaderCell,{onClick:function(){return s(t)},style:r,collapsing:!!a,children:n+(c[0]===t?c[1]?" \u2193":" \u2191":"")})}function A(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e>0&&t>0?d()(t/e*100,6):0}function L(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e>0&&t>0?d()(t/e*100,6):0}function R(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e>0&&t>0?d()(t/e,6):0}function z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e>0&&t>0?d()(t/e,6):0}function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e>0?d()(n-t,6):-t}function H(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return e>0&&n>0?t>0?d()(a/n*100,6):-100:0}var P=n(19),E=n.n(P),V=n(35),M=n(74),Q=n.n(M),B=n(49),K=n.n(B),$=n(284),G=n.n($),U=j.a.get("tsapp.dataIndex")||{},Y=j.a.get("tsapp.statsIndex")||{},J=j.a.get("tsapp.reportsIndex")||{};function q(){j.a.set("tsapp.dataIndex",U),j.a.set("tsapp.statsIndex",Y),j.a.set("tsapp.reportsIndex",J)}U.campaigns||(U.campaigns={}),U.creatives||(U.creatives={}),U.adspots||(U.adspots={}),U.urls||(U.urls={}),U.conversions||(U.conversions={}),J.campaingsList||(J.campaingsList={ttl:60,lastSync:{}}),J.campaingsCreatives||(J.campaingsCreatives={ttl:60,lastSync:{}}),J.campaingsCreativesStats||(J.campaingsCreativesStats={ttl:60,lastSync:{}}),J.campaingsAdspotsStats||(J.campaingsAdspotsStats={ttl:600,lastSync:{}}),J.creativeStats||(J.creativeStats={ttl:600,lastSync:{}});var W=Object(h.extendMoment)(b.a),X=200,Z={"Content-Type":"application/json"};function ee(){return(ee=Object(V.a)(E.a.mark((function e(t,n,a,r){var c,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Date.now(),e.next=3,K()({method:"post",mode:"no-cors",url:"https://api.trafficstars.com/v1/auth/token",headers:Object(i.a)(Object(i.a)({},Z),{},{"Content-Type":"application/x-www-form-urlencoded"}),responseType:"json",data:G.a.stringify({grant_type:"password",client_id:t,client_secret:n,username:a,password:r}),changeOrigin:!0});case 3:return s=e.sent,e.abrupt("return",{token:s.data.access_token,tokenRefresh:s.data.refresh_token,ttl:c+1e3*s.data.expires_in});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(){return(te=Object(V.a)(E.a.mark((function e(t,n,a){var r,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Date.now(),e.next=3,K()({method:"post",url:"https://api.trafficstars.com/v1/auth/token",headers:Object(i.a)(Object(i.a)({},Z),{},{"Content-Type":"application/x-www-form-urlencoded"}),responseType:"json",data:G.a.stringify({grant_type:"refresh_token",client_id:t,client_secret:n,refresh_token:a}),changeOrigin:!0});case 3:return c=e.sent,e.abrupt("return",{token:c.data.access_token,tokenRefresh:c.data.refresh_token,ttl:r+1e3*c.data.expires_in});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(e){return ae.apply(this,arguments)}function ae(){return(ae=Object(V.a)(E.a.mark((function e(t){var n,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Date.now(),e.next=3,K.a.get("https://api.trafficstars.com/v1/campaign/list",{responseType:"json",headers:Object(i.a)(Object(i.a)({},Z),{},{Authorization:"bearer "+t}),params:{size:X},changeOrigin:!0});case 3:if((a=e.sent).data.response&&a.data.response.length){e.next=6;break}return e.abrupt("return",null);case 6:a.data.response.forEach((function(e){U.campaigns[e.id]=Object(i.a)(Object(i.a)({},e),{},{creatives:U.campaigns[e.id]&&U.campaigns[e.id].creatives||[],active:1===e.status,pending:0===e.status,rejected:4===e.status,lastSync:n})}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(e,t){return ce.apply(this,arguments)}function ce(){return(ce=Object(V.a)(E.a.mark((function e(t,n){var a,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Date.now(),e.next=3,K.a.get("https://api.trafficstars.com/v1/banner/list",{responseType:"json",headers:Object(i.a)(Object(i.a)({},Z),{},{Authorization:"bearer "+t}),params:{campaign_id:n,size:X},changeOrigin:!0});case 3:if((r=e.sent).data.response&&r.data.response.length){e.next=6;break}return e.abrupt("return",null);case 6:r.data.response.forEach((function(e){e&&e.id&&e.campaign_id&&e.image&&(U.campaigns[e.campaign_id]&&(U.campaigns[e.campaign_id].creatives?U.campaigns[e.campaign_id].creatives.includes(e.id)||U.campaigns[e.campaign_id].creatives.push(e.id):U.campaigns[e.campaign_id].creatives=[e.id]),U.creatives[e.id]=Object(i.a)(Object(i.a)({},e),{},{active:1===e.status,pending:0===e.status,rejected:4===e.status,lastSync:a}),U.urls={},e.urls&&e.urls.length&&e.urls.forEach((function(e){if(!(e&&e.id&&e.url))return null;U.urls[e.url]=e})))}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(){return(se=Object(V.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne(t);case 2:return e.next=4,Q.a.map(Object.entries(U.campaigns),(function(e){var n=Object(o.a)(e,1)[0];return re(t,n)}),{concurrency:6});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(e,t,n,a){return oe.apply(this,arguments)}function oe(){return(oe=Object(V.a)(E.a.mark((function e(t,n,a,r){var c,s,o,l;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=Date.now(),!r||a===r){e.next=6;break}return s=Array.from(W.range(W(a,I),W(r,I)).by("day")).map((function(e){return e.format(I)})),e.next=5,Q.a.map(s,(function(e){return ie(t,n,e)}),{concurrency:1});case 5:return e.abrupt("return",null);case 6:if(!((o=a===W().format(I)||a===W().add(1,"d").format(I)?null:n+"-"+a)&&J.campaingsCreativesStats.lastSync[o]&&J.campaingsCreativesStats.lastSync[o]+1e3*J.campaingsCreativesStats.ttl>=c)){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,K.a.get("https://api.trafficstars.com/v1.1/advertiser/custom/report/by-creative",{responseType:"json",headers:Object(i.a)(Object(i.a)({},Z),{},{Authorization:"bearer "+t}),params:{campaign_id:n,date_from:a,date_to:a},changeOrigin:!0});case 11:if((l=e.sent).data&&l.data.length){e.next=14;break}return e.abrupt("return",null);case 14:Y[a]||(Y[a]={campaigns:{},creatives:{},adspots:{}}),l.data.forEach((function(e){e&&e.banner_id&&(Y[a].creatives[e.banner_id]=Object(i.a)(Object(i.a)({},e),{},{lastSync:c}))})),o&&(J.campaingsCreativesStats.lastSync[o]=c);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(e,t,n,a){return de.apply(this,arguments)}function de(){return(de=Object(V.a)(E.a.mark((function e(t,n,a,r){var c,s,o,l;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=Date.now(),!r||a===r){e.next=6;break}return s=Array.from(W.range(W(a,I),W(r,I)).by("day")).map((function(e){return e.format(I)})),e.next=5,Q.a.map(s,(function(e){return le(t,n,e)}),{concurrency:1});case 5:return e.abrupt("return",null);case 6:if(!((o=a===W().format(I)||a===W().add(1,"d").format(I)?null:n+"-"+a)&&J.campaingsAdspotsStats.lastSync[o]&&J.campaingsAdspotsStats.lastSync[o]+1e3*J.campaingsAdspotsStats.ttl>=c)){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,K.a.get("https://api.trafficstars.com/v1.1/advertiser/custom/report/by-spot",{responseType:"json",headers:Object(i.a)(Object(i.a)({},Z),{},{Authorization:"bearer "+t}),params:{campaign_id:n,date_from:a,date_to:a},changeOrigin:!0});case 11:l=e.sent,Y[a]||(Y[a]={campaigns:{},creatives:{},adspots:{}}),l.data.forEach((function(e){e&&e.spot_id&&(Y[a].adspots[e.spot_id]=Object(i.a)(Object(i.a)({},e),{},{lastSync:c}))})),o&&(J.campaingsAdspotsStats.lastSync[o]=c);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(e,t,n){return je.apply(this,arguments)}function je(){return(je=Object(V.a)(E.a.mark((function e(t,n,a){var r,c,s,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Date.now(),!a||n===a){e.next=6;break}return c=Array.from(W.range(W(n,I),W(a,I)).by("day")).map((function(e){return e.format(I)})),e.next=5,Q.a.map(c,(function(e){return ue(t,e)}),{concurrency:1});case 5:return e.abrupt("return",null);case 6:if(!((s=n===W().format(I)||n===W().add(1,"d").format(I)?null:n)&&J.creativeStats.lastSync[s]&&J.creativeStats.lastSync[s]+1e3*J.creativeStats.ttl>=r)){e.next=9;break}return e.abrupt("return",null);case 9:return e.next=11,K.a.get("https://api.trafficstars.com/v1.1/advertiser/custom/report/by-creative",{responseType:"json",headers:Object(i.a)(Object(i.a)({},Z),{},{Authorization:"bearer "+t}),params:{date_from:n,date_to:n},changeOrigin:!0});case 11:if((o=e.sent).data&&o.data.length){e.next=14;break}return e.abrupt("return",null);case 14:Y[n]||(Y[n]={campaigns:{},creatives:{},adspots:{}}),o.data.forEach((function(e){e&&e.banner_id&&(Y[n].creatives[e.banner_id]=Object(i.a)(Object(i.a)({},e),{},{lastSync:r}))})),s&&(J.creativeStats.lastSync[s]=r);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pe(){return(pe=Object(V.a)(E.a.mark((function e(t,n){var a,r,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Date.now(),e.next=3,K.a.put("https://api.trafficstars.com/v1/campaign/".concat(n,"/run"),{},{headers:Object(i.a)(Object(i.a)({},Z),{},{Authorization:"bearer "+t}),changeOrigin:!0});case 3:r=e.sent,(c=r.data)&&c.id&&(U.campaigns[c.id]=Object(i.a)(Object(i.a)({},c),{},{active:1===c.status,pending:0===c.status,rejected:4===c.status,lastSync:a}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(){return(be=Object(V.a)(E.a.mark((function e(t,n){var a,r,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Date.now(),e.next=3,K.a.put("https://api.trafficstars.com/v1/campaign/".concat(n,"/pause"),{},{headers:Object(i.a)(Object(i.a)({},Z),{},{Authorization:"bearer "+t}),changeOrigin:!0});case 3:r=e.sent,(c=r.data)&&c.id&&(U.campaigns[c.id]=Object(i.a)(Object(i.a)({},c),{},{active:1===c.status,pending:0===c.status,rejected:4===c.status,lastSync:a}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(){return(he=Object(V.a)(E.a.mark((function e(t,n){var a,r,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Date.now(),e.next=3,K.a.put("https://api.trafficstars.com/v1/banner/".concat(n,"/run"),{},{headers:Object(i.a)(Object(i.a)({},Z),{},{Authorization:"bearer "+t}),changeOrigin:!0});case 3:r=e.sent,(c=r.data.response)&&c.id&&(U.creatives[c.id]=Object(i.a)(Object(i.a)({},c),{},{active:1===c.status,pending:0===c.status,rejected:4===c.status,lastSync:a}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function me(){return(me=Object(V.a)(E.a.mark((function e(t,n){var a,r,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Date.now(),e.next=3,K.a.put("https://api.trafficstars.com/v1/banner/".concat(n,"/pause"),{},{headers:Object(i.a)(Object(i.a)({},Z),{},{Authorization:"bearer "+t}),changeOrigin:!0});case 3:r=e.sent,(c=r.data.response)&&c.id&&(U.creatives[c.id]=Object(i.a)(Object(i.a)({},c),{},{active:1===c.status,pending:0===c.status,rejected:4===c.status,lastSync:a}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(){return(Oe=Object(V.a)(E.a.mark((function e(t,n,a,r){var c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K()("https://partners.clickdealer.com/affiliates/api/1/reports.asmx/Conversions?api_key=".concat(t,"&affiliate_id=142387&start_date=10%2F24%2F2021%2000%3A00%3A00&end_date=10%2F25%2F2021%2023%3A59%3A59&include_tests=False&row_limit=100&currency_id=All&disposition_type=All&conversion_type=All&update_filter=False"),{method:"GET",headers:Object(i.a)({},Z),mode:"no-cors",crossdomain:!0});case 2:c=e.sent,console.log(c);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var xe={auth:function(e,t,n,a){return ee.apply(this,arguments)},authRefresh:function(e,t,n){return te.apply(this,arguments)},getCampaigns:ne,getCampaignCreatives:re,getCampaignsAndCreatives:function(e){return se.apply(this,arguments)},getCampaignCreativesStats:ie,getCampaignAdspotsStats:le,getCreativesStats:ue,runCampaign:function(e,t){return pe.apply(this,arguments)},pauseCampaign:function(e,t){return be.apply(this,arguments)},runCreative:function(e,t){return he.apply(this,arguments)},pauseCreative:function(e,t){return me.apply(this,arguments)},getConversions:function(e,t,n,a){return Oe.apply(this,arguments)},getImageUrl:function(e){return"https://admin.trafficstars.com/media/"+e}},fe=(n(415),n(88)),ge=n.n(fe),ve=n(598),ye=n(548),Ce=n(602),ke=n(599),Se=n(146),we=n(72),Fe=(n(489),n(48)),Ne=n.n(Fe),Ie=n(597),De=n(340);n(490);var _e=function(e){var t=e.stats;return t?Object(N.jsxs)("div",{style:{textAlign:"center"},children:[Ne()(t.impressions)&&Object(N.jsxs)(De.a,{size:"mini",style:{marginRight:"20px"},children:[Object(N.jsx)(De.a.Value,{children:t.impressions.toLocaleString()}),Object(N.jsx)(De.a.Label,{children:"Impressions"})]}),Ne()(t.clicks)&&Object(N.jsxs)(De.a,{size:"mini",style:{marginRight:"20px"},children:[Object(N.jsx)(De.a.Value,{children:t.clicks.toLocaleString()}),Object(N.jsx)(De.a.Label,{children:"Clicks"})]}),Ne()(t.leads)&&Object(N.jsxs)(De.a,{size:"mini",style:{marginRight:"20px"},children:[Object(N.jsx)(De.a.Value,{children:t.leads.toLocaleString()}),Object(N.jsx)(De.a.Label,{children:"Leads"})]}),Ne()(t.ctr)&&Object(N.jsxs)(De.a,{size:"mini",style:{marginRight:"20px"},children:[Object(N.jsxs)(De.a.Value,{children:[t.ctr.toFixed(3),"%"]}),Object(N.jsx)(De.a.Label,{children:"CTR"})]}),Ne()(t.cr)&&Object(N.jsxs)(De.a,{size:"mini",style:{marginRight:"20px"},children:[Object(N.jsxs)(De.a.Value,{children:[t.cr.toFixed(3),"%"]}),Object(N.jsx)(De.a.Label,{children:"CR"})]}),Ne()(t.ecpc)&&Object(N.jsxs)(De.a,{size:"mini",style:{marginRight:"20px"},children:[Object(N.jsxs)(De.a.Value,{children:[t.ecpc.toFixed(3),"$"]}),Object(N.jsx)(De.a.Label,{children:"ECPC"})]}),Ne()(t.ecpa)&&Object(N.jsxs)(De.a,{size:"mini",style:{marginRight:"20px"},children:[Object(N.jsxs)(De.a.Value,{children:[t.ecpa.toFixed(3),"$"]}),Object(N.jsx)(De.a.Label,{children:"ECPA"})]}),Ne()(t.price)&&Object(N.jsxs)(De.a,{size:"mini",style:{marginRight:"20px"},children:[Object(N.jsxs)(De.a.Value,{children:[t.price.toFixed(3).toLocaleString(),"$"]}),Object(N.jsx)(De.a.Label,{children:"Price"})]}),Ne()(t.income)&&Object(N.jsxs)(De.a,{size:"mini",style:{marginRight:"20px"},color:t.income>0?"green":"red",children:[Object(N.jsxs)(De.a.Value,{children:[t.income.toFixed(3).toLocaleString(),"$"]}),Object(N.jsx)(De.a.Label,{children:"Income"})]}),Ne()(t.revenue)&&Object(N.jsxs)(De.a,{size:"mini",style:{marginRight:"20px"},color:t.revenue>0?"green":"red",children:[Object(N.jsxs)(De.a.Value,{children:[t.revenue.toFixed(3).toLocaleString(),"$"]}),Object(N.jsx)(De.a.Label,{children:"Revenue"})]}),Ne()(t.roi)&&Object(N.jsxs)(De.a,{size:"mini",color:t.roi>16?"green":t.roi>0?"orange":"red",children:[Object(N.jsxs)(De.a.Value,{children:[t.roi.toFixed(3),"%"]}),Object(N.jsx)(De.a.Label,{children:"ROI"})]})]}):Object(N.jsx)("div",{style:{textAlign:"center"},children:Object(N.jsx)(Ie.a,{fluid:!0,children:Object(N.jsxs)(Ie.a.Paragraph,{children:[Object(N.jsx)(Ie.a.Line,{}),Object(N.jsx)(Ie.a.Line,{}),Object(N.jsx)(Ie.a.Line,{}),Object(N.jsx)(Ie.a.Line,{})]})})})},Ae=Object(h.extendMoment)(b.a);var Le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.switchStamp,n=e.auth,r=e.dates,c=e.setDates,s=e.searchQuery,l=e.setSearchQuery,u=Object(a.useState)({rows:[],rowsCount:-1}),p=Object(o.a)(u,2),b=p[0],h=p[1],x=Object(a.useState)(!1),v=Object(o.a)(x,2),y=v[0],S=v[1],w=Object(a.useState)(null),P=Object(o.a)(w,2),M=P[0],B=P[1],K=Object(a.useState)({}),$=Object(o.a)(K,2),G=$[0],J=$[1],W=Object(a.useState)({}),X=Object(o.a)(W,2),Z=X[0],ee=X[1],te=j.a.get("tsapp.campaigns.filter")||{},ne=Object(a.useState)([te.sortProp||"cr",te.sortValue||!1]),ae=Object(o.a)(ne,2),re=ae[0],ce=ae[1],se=Object(a.useState)("all"),ie=Object(o.a)(se,2),oe=ie[0],le=ie[1];function de(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];S(!0),(e?Q.a.all([xe.getCampaignsAndCreatives(n.token),xe.getCreativesStats(n.token,r.from,r.to)]):Q.a.all([Q.a.resolve(Object.entries(U.campaigns).map((function(e){var t=Object(o.a)(e,2);t[0];return t[1]}))),xe.getCreativesStats(n.token,r.from,r.to)])).then(Object(V.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=Object.entries(U.campaigns).map((function(e){var t=Object(o.a)(e,2);t[0];return t[1]}))).length&&q(),h({rows:t,rowsCount:t.length}),S(!1);case 4:case"end":return e.stop()}}),e)})))).catch((function(e){console.error(e),h({rows:[],rowsCount:-1});var t=e.toString();B(t),S(!1)}))}function ue(e){ce([e,re[0]===e&&!re[1]])}function je(e){G[e]?delete G[e]:G[e]=!0,J(Object(i.a)({},G))}function pe(e){Z[e]?delete Z[e]:Z[e]=!0,ee(Object(i.a)({},Z))}function be(e){S(!0),xe.runCampaign(n.token,e).then((function(){return de(!0)})).catch((function(e){B(e.toString()),S(!1)}))}function he(e){S(!0),xe.pauseCampaign(n.token,e).then((function(){return de(!0)})).catch((function(e){B(e.toString()),S(!1)}))}function me(e){S(!0),xe.runCreative(n.token,e).then((function(){return de(!0)})).catch((function(e){B(e.toString()),S(!1)}))}function Oe(e){S(!0),xe.pauseCreative(n.token,e).then((function(){return de(!0)})).catch((function(e){B(e.toString()),S(!1)}))}Object(a.useEffect)((function(){return y||M||!n||!n.token?null:b.rowsCount<0?(de(0===t),null):void 0}));var fe={impressions:0,clicks:0,leads:0,price:0,income:0,ctr:0,cr:0,ecpc:0,ecpa:0,revenue:0,roi:0},Fe=Array.from(Ae.range(Ae(r.from,I),Ae(r.to,I)).by("day")).map((function(e){return e.format(I)})),Ne=0,Ie=[],De=[];return b&&b.rows&&b.rows.length&&b.rows.forEach((function(e){switch(oe){case"active":case"active-all":if(!e.active)return null;break;case"disabled":if(e.active)return null;break;case"pending":if(!e.pending)return null}if(s&&!~(e.id+"").indexOf(s.toLowerCase())&&!~e.name.toLowerCase().indexOf(s.toLowerCase()))return null;var t=[],n=[],a=e&&e.creatives&&e.creatives.length?e.creatives.length:0;e.impressions=0,e.clicks=0,e.leads=0,e.price=0,e.income=0,a>0&&e.creatives.forEach((function(t){var a=U.creatives[t];if(!a)return null;switch(oe){case"active-all":if(!a.active)return null}a.impressions=0,a.clicks=0,a.leads=0,a.price=0,a.income=0,Fe.forEach((function(e){if(!Y[e]||!Y[e].creatives[t])return null;var n=Y[e].creatives[t];a.impressions+=n.impressions,a.clicks+=n.clicks,a.leads+=n.leads,a.price+=n.amount,a.income+=n.lead_price})),Z["b-"+t]||(e.impressions+=a.impressions,e.clicks+=a.clicks,e.leads+=a.leads,e.price+=a.price,e.income+=a.income),a.ctr=A(a.impressions,a.clicks),a.cr=L(a.clicks,a.leads),a.ecpc=R(a.clicks,a.price),a.ecpa=z(a.leads,a.price),a.revenue=T(a.impressions,a.price,a.income),a.roi=H(a.impressions,a.leads,a.price,a.revenue),n.push(a)})),e.ctr=A(e.impressions,e.clicks),e.cr=L(e.clicks,e.leads),e.ecpc=R(e.clicks,e.price),e.ecpa=z(e.leads,e.price),e.revenue=T(e.leads,e.price,e.income),e.roi=H(e.impressions,e.leads,e.price,e.revenue),Ie.push(Object(i.a)(Object(i.a)({},e),{},{campaignIndex:Ne++})),Z["c-"+e.id]||(fe.impressions+=e.impressions,fe.clicks+=e.clicks,fe.leads+=e.leads,fe.price+=e.price,fe.income+=e.income),t.push(Object(N.jsxs)(F.a.Row,{style:{textDecoration:Z["c-"+e.id]?"line-through":""},warning:!e.active||e.pending,active:!!G["c-"+e.id],children:[Object(N.jsx)(F.a.Cell,{className:"tac",children:e.pending?Object(N.jsx)(ve.a,{active:!0,inline:!0,size:"mini"}):Object(N.jsx)(k.a,{toggle:!0,checked:!!e.active,onClick:function(){return e.active?he(e.id):be(e.id)}})}),Object(N.jsx)(F.a.Cell,{className:"monoFont",style:{cursor:a&&"pointer"},onClick:function(){return a&&je("c-"+e.id)},children:e.id}),Object(N.jsxs)(F.a.Cell,{className:"monoFont",style:{cursor:a&&"pointer"},onClick:function(){return a&&je("c-"+e.id)},children:[e&&e.countries&&e.countries.length>0&&e.countries.map((function(e){return Object(N.jsx)(ye.a,{name:e.toLowerCase()},"countryCode-"+e)})),a?Object(N.jsx)("b",{children:e.name}):e.name]}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(e.impressions/1e3,3)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(e.clicks,0)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(e.leads,0)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(e.ctr,2)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(e.cr,2)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(e.price,3)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(e.income,3)}),Object(N.jsxs)(F.a.Cell,{className:"tar monoFont",positive:e.revenue>0,negative:e.revenue<0,children:[e.revenue>0?"+":"",D(e.revenue,3)]}),Object(N.jsxs)(F.a.Cell,{className:"tar monoFont",style:{cursor:"pointer"},positive:e.roi>0,negative:e.roi<0,onClick:function(){return pe("c-"+e.id)},children:[e.roi>0?"+":"",D(e.roi,2)]})]},"campaign-"+e.id)),a&&G["c-"+e.id]&&ge()(n,re[0],re[1]?"asc":"desc").forEach((function(n){var a=n.urls.filter((function(e){return e&&1===e.status&&e.id&&e.url})),r=xe.getImageUrl(n.image);t.push(Object(N.jsxs)(F.a.Row,{warning:!n.active||n.pending,style:{fontSize:"0.8em",textDecoration:Z["b-"+n.id]?"line-through":""},children:[Object(N.jsx)(F.a.Cell,{className:"tac",children:n.pending?Object(N.jsx)(ve.a,{active:!0,inline:!0,size:"mini"}):n.rejected?Object(N.jsx)(g.a,{color:"red",style:{margin:"0 5px 0 0",padding:"2px"},size:"tiny",icon:"warning"}):Object(N.jsx)(k.a,{slider:!0,disabled:!(e&&e.active),checked:!!(e&&e.active&&n.active),onClick:function(){return e&&e.active&&n.active?Oe(n.id):me(n.id)}})}),Object(N.jsxs)(F.a.Cell,{className:"monoFont",children:["\u21b3","\u2009",n.id]}),Object(N.jsxs)(F.a.Cell,{className:"monoFont",children:[Object(N.jsx)(Ce.a,{position:"right center",flowing:!0,hoverable:!0,trigger:Object(N.jsx)(g.a,{color:"blue",style:{margin:"0 5px 0 0",padding:"2px"},size:"tiny",icon:"image"}),children:Object(N.jsx)(ke.a.Group,{children:Object(N.jsxs)(ke.a,{children:[Object(N.jsx)(ke.a.Avatar,{href:r,title:r,alt:r,rel:"noreferrer",target:"_blank",src:r}),Object(N.jsxs)(ke.a.Content,{children:[Object(N.jsx)("span",{className:"author",children:n.brandname}),Object(N.jsxs)(ke.a.Text,{style:{margin:"0",padding:"0"},children:[Object(N.jsx)("p",{style:{marginBottom:"3px"},children:n.headline}),a.length>0&&Object(N.jsx)("ul",{style:{margin:"0",padding:"0"},children:a.map((function(e){return Object(N.jsx)("li",{style:{listStyle:"none"},children:Object(N.jsx)("a",{href:e.url,title:e.url,alt:e.url,rel:"noreferrer",target:"_blank",children:e.id})},e)}))})]})]})]})})}),n.brandname]}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(n.impressions/1e3,3)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(n.clicks,0)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(n.leads,0)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(n.ctr,2)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(n.cr,2)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(n.price,3)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(n.income,3)}),Object(N.jsxs)(F.a.Cell,{className:"tar monoFont",positive:n.revenue>0,negative:n.revenue<0,children:[n.revenue>0?"+":"",D(n.revenue,3)]}),Object(N.jsxs)(F.a.Cell,{className:"tar monoFont",style:{cursor:"pointer"},positive:n.roi>0,negative:n.roi<0,onClick:function(){return pe("b-"+n.id)},children:[n.revenue>0?"+":"",D(n.roi,2)]})]},"campaign-"+e.id+"-creative-"+n.id))})),De.push(t)})),fe.ctr=A(fe.impressions,fe.clicks),fe.cr=L(fe.clicks,fe.leads),fe.ecpc=R(fe.clicks,fe.price),fe.ecpa=z(fe.leads,fe.price),fe.revenue=T(fe.impressions,fe.price,fe.income),fe.roi=H(fe.impressions,fe.leads,fe.price,fe.revenue),Object(N.jsxs)(N.Fragment,{children:[M&&Object(N.jsxs)(f.a,{inverted:!0,color:"red",onClick:function(){return B(null)},children:[Object(N.jsx)(g.a,{onClick:function(){return B(null)},floated:"right",color:"red",icon:"close",size:"tiny",style:{marginTop:"-6px"}}),Object(N.jsx)("p",{children:M})]}),Object(N.jsx)(_e,{stats:b.rowsCount>0&&fe}),Object(N.jsxs)(f.a,{loading:y,style:{padding:"0",border:"0"},children:[Object(N.jsxs)(m.a,{attached:"top",children:[Object(N.jsxs)(m.a.Item,{children:[Object(N.jsx)(we.DateInput,{style:{width:"133px"},disabled:y,placeholder:"Date From",dateFormat:I,value:r.from,iconPosition:"left",maxDate:r.to,onChange:function(e,t){return c(Object(i.a)(Object(i.a)({},r),{},{from:t.value}))}}),Object(N.jsx)(we.DateInput,{style:{width:"133px",marginLeft:"5px"},disabled:y,placeholder:"Date To",dateFormat:I,value:r.to,iconPosition:"left",minDate:r.from,maxDate:Ae().format(I),onChange:function(e,t){return c(Object(i.a)(Object(i.a)({},r),{},{to:t.value}))}})]}),Object(N.jsx)(m.a.Item,{children:Object(N.jsx)(Se.a,{placeholder:"State",compact:!0,style:{width:"120px"},onChange:function(e,t){return le(t.value)},value:oe,selection:!0,options:[{key:"all",text:"All",value:"all"},{key:"active",text:"Active",value:"active"},{key:"active-all",text:"Active All",value:"active-all"},{key:"disabled",text:"Disabled",value:"disabled"},{key:"pending",text:"Pending",value:"pending"}]})}),Object(N.jsxs)(m.a.Menu,{position:"right",children:[Object(N.jsx)(m.a.Item,{children:Object(N.jsx)(C.a,{placeholder:"Search",style:{width:"240px"},value:s,onChange:function(e){return l(e.target.value)}})}),Object(N.jsxs)(m.a.Item,{disabled:y,onClick:function(){return de(!0)},children:[Object(N.jsx)(O.a,{name:"refresh",color:"violet"}),"Load Data"]}),Object(N.jsxs)(m.a.Item,{disabled:y,onClick:function(){return de()},children:[Object(N.jsx)(O.a,{name:"refresh",color:"blue"}),"Load Stats"]})]})]}),Object(N.jsxs)(F.a,{compact:!0,striped:!0,sortable:!0,celled:!0,selectable:!0,attached:"bottom",children:[Object(N.jsx)(F.a.Header,{children:Object(N.jsxs)(F.a.Row,{children:[Object(N.jsx)(_,{sort:re,onSort:ue,style:{width:"50px"},prop:"active",title:"Active"}),Object(N.jsx)(_,{sort:re,onSort:ue,style:{width:"80px"},prop:"id",title:"ID"}),Object(N.jsx)(_,{sort:re,onSort:ue,prop:"name",title:"Name"}),Object(N.jsx)(_,{sort:re,onSort:ue,style:{width:"90px"},prop:"impressions",title:"Imprs"}),Object(N.jsx)(_,{sort:re,onSort:ue,style:{width:"85px"},prop:"clicks",title:"Clicks"}),Object(N.jsx)(_,{sort:re,onSort:ue,style:{width:"85px"},prop:"leads",title:"Leads"}),Object(N.jsx)(_,{sort:re,onSort:ue,style:{width:"85px"},prop:"ctr",title:"CTR %"}),Object(N.jsx)(_,{sort:re,onSort:ue,style:{width:"85px"},prop:"cr",title:"CR %"}),Object(N.jsx)(_,{sort:re,onSort:ue,style:{width:"85px"},prop:"price",title:"Price"}),Object(N.jsx)(_,{sort:re,onSort:ue,style:{width:"85px"},prop:"income",title:"Income"}),Object(N.jsx)(_,{sort:re,onSort:ue,style:{width:"85px"},prop:"revenue",title:"Revenue"}),Object(N.jsx)(_,{sort:re,onSort:ue,style:{width:"85px"},prop:"roi",title:"ROI %"})]})}),Object(N.jsx)(F.a.Body,{children:ge()(Ie,re[0],re[1]?"asc":"desc").map((function(e){return De[e.campaignIndex]}))}),Object(N.jsx)(F.a.Footer,{children:Object(N.jsxs)(F.a.Row,{children:[Object(N.jsxs)(F.a.HeaderCell,{colSpan:3,children:["Count: ",Ie.length]}),Object(N.jsx)(F.a.HeaderCell,{className:"tar monoFont",children:d()(fe.impressions/1e3,3).toFixed(3)}),Object(N.jsx)(F.a.HeaderCell,{className:"tar monoFont",children:fe.clicks}),Object(N.jsx)(F.a.HeaderCell,{className:"tar monoFont",children:fe.leads}),Object(N.jsx)(F.a.HeaderCell,{className:"tar monoFont",children:fe.ctr.toFixed(2)}),Object(N.jsx)(F.a.HeaderCell,{className:"tar monoFont",children:fe.cr.toFixed(2)}),Object(N.jsx)(F.a.HeaderCell,{className:"tar monoFont",children:d()(fe.price,3).toFixed(3)}),Object(N.jsx)(F.a.HeaderCell,{className:"tar monoFont",children:d()(fe.income,3).toFixed(3)}),Object(N.jsx)(F.a.HeaderCell,{className:"tar monoFont",children:(fe.revenue>0?"+":"")+d()(fe.revenue,3).toFixed(3)}),Object(N.jsxs)(F.a.HeaderCell,{className:"tar monoFont",children:[(fe.roi>0?"+":"")+d()(fe.roi,2),"%"]})]})})]})]})]})},Re=n(223),ze=(n(545),Object(h.extendMoment)(b.a));var Te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.switchStamp,n=e.auth,r=e.dates,c=e.setDates,s=e.searchQuery,l=e.setSearchQuery,u=Object(a.useState)({rows:[],rowsCount:-1}),p=Object(o.a)(u,2),b=p[0],h=p[1],x=Object(a.useState)(!1),v=Object(o.a)(x,2),y=v[0],S=v[1],w=Object(a.useState)(null),P=Object(o.a)(w,2),E=P[0],V=P[1],M=Object(a.useState)({}),Q=Object(o.a)(M,2),B=Q[0],K=Q[1],$=Object(a.useState)({}),G=Object(o.a)($,2),J=G[0],W=G[1],X=j.a.get("tsapp.banners.filter")||{},Z=Object(a.useState)([X.sortProp||"cr",X.sortValue||!1]),ee=Object(o.a)(Z,2),te=ee[0],ne=ee[1],ae=Object(a.useState)("all"),re=Object(o.a)(ae,2),ce=re[0],se=re[1];function ie(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];S(!0),(e?Promise.all([xe.getCampaignsAndCreatives(n.token),xe.getCreativesStats(n.token,r.from,r.to)]):xe.getCreativesStats(n.token,r.from,r.to)).then((function(){var e=Object.entries(U.creatives).map((function(e){var t=Object(o.a)(e,2);t[0];return t[1]}));e.length&&q(),h({rows:e,rowsCount:e.length}),S(!1)})).catch((function(e){console.error(e),h({rows:[],rowsCount:-1});var t=e.toString();V(t),S(!1)}))}function oe(e){ne([e,te[0]===e&&!te[1]])}function le(e){B[e]?delete B[e]:B[e]=!0,K(Object(i.a)({},B))}function de(e){J[e]?delete J[e]:J[e]=!0,W(Object(i.a)({},J))}function ue(e){S(!0),xe.runCreative(n.token,e).then((function(){return ie(!0)})).catch((function(e){V(e.toString()),S(!1)}))}function je(e){S(!0),xe.pauseCreative(n.token,e).then((function(){return ie(!0)})).catch((function(e){V(e.toString()),S(!1)}))}Object(a.useEffect)((function(){return y||E||!n||!n.token?null:b.rowsCount<0?(ie(0===t),null):void 0}));var pe={impressions:0,clicks:0,leads:0,price:0,income:0,ctr:0,cr:0,ecpc:0,ecpa:0,revenue:0,roi:0},be=Array.from(ze.range(ze(r.from,I),ze(r.to,I)).by("day")).map((function(e){return e.format(I)})),he=0,me=[],Oe={},fe=[];return b.rows.forEach((function(e){var t,n=e&&e.id;if(!n||!U.creatives[n])return null;if(e.campaign_id&&(t=U.campaigns[e.campaign_id]),"all"!==ce)switch(ce){case"active":if(!e.active||e.pending||!t||!t.active)return null;break;case"disabled":if(e.active||e.pending||!t||!t.active)return null;break;case"pending":if(!e||!e.pending)return null}if(s){var a=s.toLowerCase();if(!~(e.id+"").indexOf(a)&&!~e.brandname.toLowerCase().indexOf(a)&&!~e.headline.toLowerCase().indexOf(a)&&t&&!~t.name.toLowerCase().indexOf(a))return null}var r=he++,c=xe.getImageUrl(e.image);e.impressions=0,e.clicks=0,e.leads=0,e.price=0,e.income=0,e.ctr=0,e.cr=0,e.ecpc=0,e.ecpa=0,e.revenue=0,e.roi=0,be.forEach((function(t){if(!Y[t]||!Y[t].creatives[n])return null;var a=Y[t].creatives[n];e.impressions+=a.impressions,e.clicks+=a.clicks,e.leads+=a.leads,e.price+=a.amount,e.income+=a.lead_price})),e.ctr=A(e.impressions,e.clicks),e.cr=L(e.clicks,e.leads),e.ecpc=R(e.clicks,e.price),e.ecpa=z(e.leads,e.price),e.revenue=T(e.impressions,e.price,e.income),e.roi=H(e.impressions,e.leads,e.price,e.revenue),Oe[c]?Oe[c].creatives[n]=e:Oe[c]={bannerIndex:r,imageUrl:c,creatives:Object(Re.a)({},n,e)}})),Object.keys(Oe).forEach((function(e,t){var n=Oe[e];n.impressions=0,n.clicks=0,n.leads=0,n.price=0,n.income=0,n.ctr=0,n.cr=0,n.ecpc=0,n.ecpa=0,n.revenue=0,n.roi=0,n.creatives=Object.entries(n.creatives).map((function(e){var t=Object(o.a)(e,2),a=t[0],r=t[1];return B["c-"+a]||(n.impressions+=r.impressions,n.clicks+=r.clicks,n.leads+=r.leads,n.price+=r.price,n.income+=r.income),r})),n.ctr=A(n.impressions,n.clicks),n.cr=L(n.clicks,n.leads),n.ecpc=R(n.clicks,n.price),n.ecpa=z(n.leads,n.price),n.revenue=T(n.impressions,n.price,n.income),n.roi=H(n.impressions,n.leads,n.price,n.revenue),B["bi-"+e]||(pe.impressions+=n.impressions,pe.clicks+=n.clicks,pe.leads+=n.leads,pe.price+=n.price,pe.income+=n.income),me.push(Object(i.a)(Object(i.a)({},n),{},{bannerIndex:t}));var a=[Object(N.jsxs)(F.a.Row,{style:{textDecoration:B["bi-"+e]?"line-through":""},active:!!J["bi-"+e],children:[Object(N.jsxs)(F.a.Cell,{colSpan:3,className:"monoFont",style:{cursor:"pointer"},onClick:function(){return de("bi-"+e)},children:[Object(N.jsx)(Ce.a,{position:"right center",flowing:!0,hoverable:!0,trigger:Object(N.jsx)(g.a,{color:"blue",style:{margin:"3px 5px 2px 2px",padding:"4px"},size:"tiny",icon:"image"}),children:Object(N.jsx)(ke.a.Group,{children:Object(N.jsx)(ke.a,{children:Object(N.jsx)(ke.a.Avatar,{href:e,title:e,alt:e,rel:"noreferrer",target:"_blank",src:e})})})}),"/"+e.split("/").slice(-5).join("/")]}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(n.impressions/1e3,3)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(n.clicks,0)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(n.leads,0)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(n.ctr,2)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(n.cr,2)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(n.price,3)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(n.income,3)}),Object(N.jsxs)(F.a.Cell,{className:"tar monoFont",positive:n.revenue>0,negative:n.revenue<0,children:[n.revenue>0?"+":"",D(n.revenue,3)]}),Object(N.jsxs)(F.a.Cell,{className:"tar monoFont",style:{cursor:"pointer"},positive:n.roi>0,negative:n.roi<0,onClick:function(){return le("bi-"+e)},children:[n.revenue>0?"+":"",D(n.roi,2)]})]},"bannerImage-"+n.id)];J["bi-"+e]&&ge()(n.creatives,te[0],te[1]?"asc":"desc").forEach((function(e){var t,n=e.urls.filter((function(e){return e&&1===e.status&&e.id&&e.url}));e.campaign_id&&(t=U.campaigns[e.campaign_id]),a.push(Object(N.jsxs)(F.a.Row,{warning:!e.active||e.pending||!t||!t.active,style:{fontSize:"0.8em",textDecoration:B["c-"+e.id]?"line-through":""},children:[Object(N.jsx)(F.a.Cell,{className:"tac",children:e.pending?Object(N.jsx)(ve.a,{active:!0,inline:!0,size:"mini"}):e.rejected?Object(N.jsx)(g.a,{color:"red",style:{margin:"0 5px 0 0",padding:"2px"},size:"tiny",icon:"warning"}):Object(N.jsx)(k.a,{slider:!0,disabled:!(t&&t.active),checked:!!(t&&t.active&&e.active),onClick:function(){return t&&t.active&&e.active?je(e.id):ue(e.id)}})}),Object(N.jsxs)(F.a.Cell,{className:"monoFont",children:["\u21b3","\u2009",e.id]}),Object(N.jsxs)(F.a.Cell,{className:"monoFont",children:[t&&t.countries&&t.countries.length>0&&t.countries.map((function(e){return Object(N.jsx)(ye.a,{name:e.toLowerCase()},"countryCode-"+e)})),t&&Object(N.jsx)("b",{children:t.name}),"\xa0",Object(N.jsx)(Ce.a,{position:"right center",flowing:!0,hoverable:!0,trigger:Object(N.jsx)(g.a,{color:"blue",style:{margin:"0 5px 0 0",padding:"2px"},size:"tiny",icon:"info"}),children:Object(N.jsx)(ke.a.Group,{children:Object(N.jsx)(ke.a,{children:Object(N.jsxs)(ke.a.Content,{children:[Object(N.jsx)("span",{className:"author",children:e.brandname}),Object(N.jsxs)(ke.a.Text,{style:{margin:"0",padding:"0"},children:[Object(N.jsx)("p",{style:{marginBottom:"3px"},children:e.headline}),n.length>0&&Object(N.jsx)("ul",{style:{margin:"0",padding:"0"},children:n.map((function(e){return Object(N.jsx)("li",{style:{listStyle:"none"},children:Object(N.jsx)("a",{href:e.url,title:e.url,alt:e.url,rel:"noreferrer",target:"_blank",children:e.id})},e)}))})]})]})})})}),Object(N.jsx)("i",{children:e.brandname})]}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(e.impressions/1e3,3)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(e.clicks,0)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(e.leads,0)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(e.ctr,2)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(e.cr,2)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(e.price,3)}),Object(N.jsx)(F.a.Cell,{className:"tar monoFont",children:D(e.income,3)}),Object(N.jsxs)(F.a.Cell,{className:"tar monoFont",positive:e.revenue>0,negative:e.revenue<0,children:[e.revenue>0?"+":"",D(e.revenue,3)]}),Object(N.jsxs)(F.a.Cell,{className:"tar monoFont",style:{cursor:"pointer"},positive:e.roi>0,negative:e.roi<0,onClick:function(){return le("c-"+e.id)},children:[e.revenue>0?"+":"",D(e.roi,2)]})]},"creative-"+e.id))})),fe.push(a)})),pe.ctr=A(pe.impressions,pe.clicks),pe.cr=A(pe.clicks,pe.leads),pe.ecpc=R(pe.clicks,pe.price),pe.ecpa=z(pe.leads,pe.price),pe.revenue=T(pe.impressions,pe.price,pe.income),pe.roi=H(pe.impressions,pe.leads,pe.price,pe.revenue),Object(N.jsxs)(N.Fragment,{children:[E&&Object(N.jsxs)(f.a,{inverted:!0,color:"red",onClick:function(){return V(null)},children:[Object(N.jsx)(g.a,{onClick:function(){return V(null)},floated:"right",color:"red",icon:"close",size:"tiny",style:{marginTop:"-6px"}}),Object(N.jsx)("p",{children:E})]}),Object(N.jsx)(_e,{stats:b.rowsCount>0&&pe}),Object(N.jsxs)(f.a,{loading:y,style:{padding:"0",border:"0"},children:[Object(N.jsxs)(m.a,{attached:"top",children:[Object(N.jsxs)(m.a.Item,{children:[Object(N.jsx)(we.DateInput,{style:{width:"133px"},disabled:y,placeholder:"Date From",dateFormat:I,value:r.from,iconPosition:"left",maxDate:r.to,onChange:function(e,t){return c(Object(i.a)(Object(i.a)({},r),{},{from:t.value}))}}),Object(N.jsx)(we.DateInput,{style:{width:"133px",marginLeft:"5px"},disabled:y,placeholder:"Date To",dateFormat:I,value:r.to,iconPosition:"left",minDate:r.from,maxDate:ze().format(I),onChange:function(e,t){return c(Object(i.a)(Object(i.a)({},r),{},{to:t.value}))}})]}),Object(N.jsx)(m.a.Item,{children:Object(N.jsx)(Se.a,{placeholder:"State",compact:!0,style:{width:"120px"},onChange:function(e,t){return se(t.value)},value:ce,selection:!0,options:[{key:"all",text:"All",value:"all"},{key:"active",text:"Active",value:"active"},{key:"disabled",text:"Disabled",value:"disabled"},{key:"pending",text:"Pending",value:"pending"}]})}),Object(N.jsxs)(m.a.Menu,{position:"right",children:[Object(N.jsx)(m.a.Item,{children:Object(N.jsx)(C.a,{placeholder:"Search",style:{width:"240px"},value:s,onChange:function(e){return l(e.target.value)}})}),Object(N.jsxs)(m.a.Item,{disabled:y,onClick:function(){return ie(!0)},children:[Object(N.jsx)(O.a,{name:"refresh",color:"violet"}),"Load Data"]}),Object(N.jsxs)(m.a.Item,{disabled:y,onClick:function(){return ie()},children:[Object(N.jsx)(O.a,{name:"refresh",color:"blue"}),"Load Stats"]})]})]}),Object(N.jsxs)(F.a,{compact:!0,striped:!0,sortable:!0,celled:!0,selectable:!0,attached:"bottom",children:[Object(N.jsx)(F.a.Header,{children:Object(N.jsxs)(F.a.Row,{children:[Object(N.jsx)(_,{sort:te,onSort:oe,style:{width:"65px"},prop:"active",title:"Active"}),Object(N.jsx)(_,{sort:te,onSort:oe,style:{width:"80px"},prop:"id",title:"ID"}),Object(N.jsx)(_,{sort:te,onSort:oe,prop:"name",title:"Name"}),Object(N.jsx)(_,{sort:te,onSort:oe,style:{width:"90px"},prop:"impressions",title:"Imprs"}),Object(N.jsx)(_,{sort:te,onSort:oe,style:{width:"85px"},prop:"clicks",title:"Clicks"}),Object(N.jsx)(_,{sort:te,onSort:oe,style:{width:"85px"},prop:"leads",title:"Leads"}),Object(N.jsx)(_,{sort:te,onSort:oe,style:{width:"85px"},prop:"ctr",title:"CTR %"}),Object(N.jsx)(_,{sort:te,onSort:oe,style:{width:"85px"},prop:"cr",title:"CR %"}),Object(N.jsx)(_,{sort:te,onSort:oe,style:{width:"85px"},prop:"price",title:"Price"}),Object(N.jsx)(_,{sort:te,onSort:oe,style:{width:"85px"},prop:"income",title:"Income"}),Object(N.jsx)(_,{sort:te,onSort:oe,style:{width:"85px"},prop:"revenue",title:"Revenue"}),Object(N.jsx)(_,{sort:te,onSort:oe,style:{width:"85px"},prop:"roi",title:"ROI %"})]})}),Object(N.jsx)(F.a.Body,{children:ge()(me,te[0],te[1]?"asc":"desc").map((function(e){return fe[e.bannerIndex]}))}),Object(N.jsx)(F.a.Footer,{children:Object(N.jsxs)(F.a.Row,{children:[Object(N.jsxs)(F.a.HeaderCell,{colSpan:3,children:["Count: ",me.length]}),Object(N.jsx)(F.a.HeaderCell,{className:"tar monoFont",children:d()(pe.impressions/1e3,3).toFixed(3)}),Object(N.jsx)(F.a.HeaderCell,{className:"tar monoFont",children:pe.clicks}),Object(N.jsx)(F.a.HeaderCell,{className:"tar monoFont",children:pe.leads}),Object(N.jsx)(F.a.HeaderCell,{className:"tar monoFont",children:pe.ctr.toFixed(2)}),Object(N.jsx)(F.a.HeaderCell,{className:"tar monoFont",children:pe.cr.toFixed(2)}),Object(N.jsx)(F.a.HeaderCell,{className:"tar monoFont",children:d()(pe.price,3).toFixed(3)}),Object(N.jsx)(F.a.HeaderCell,{className:"tar monoFont",children:d()(pe.income,3).toFixed(3)}),Object(N.jsx)(F.a.HeaderCell,{className:"tar monoFont",children:(pe.revenue>0?"+":"")+d()(pe.revenue,3).toFixed(3)}),Object(N.jsxs)(F.a.HeaderCell,{className:"tar monoFont",children:[(pe.roi>0?"+":"")+d()(pe.roi,2),"%"]})]})})]})]})]})},He=(n(546),Object(h.extendMoment)(b.a));var Pe=function(e){var t=e.switchStamp,n=e.auth,r=e.dates,c=e.setDates,s=e.searchQuery,l=e.setSearchQuery,d=Object(a.useState)({rows:[],rowsCount:-1}),u=Object(o.a)(d,2),p=u[0],b=u[1],h=Object(a.useState)(!1),x=Object(o.a)(h,2),v=x[0],y=x[1],k=Object(a.useState)(null),S=Object(o.a)(k,2),w=S[0],D=S[1],A=j.a.get("tsapp.conversions.filter")||{},L=Object(a.useState)([A.sortProp||"cr",A.sortValue||!1]),R=Object(o.a)(L,2),z=R[0],T=R[1],H=Object(a.useState)("all"),P=Object(o.a)(H,2),E=P[0],V=P[1];function M(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];y(!0),(e?Promise.all([xe.getCampaignsAndCreatives(n.token),xe.getConversions(n.apiKey,142387)]):xe.getConversions(n.apiKey,142387)).then((function(){var e=Object.entries(U.urls).map((function(e){var t=Object(o.a)(e,2);t[0];return t[1]}));e.length&&q(),b({rows:e,rowsCount:e.length}),y(!1)})).catch((function(e){console.error(e),b({rows:[],rowsCount:-1});var t=e.toString();D(t),y(!1)}))}Object(a.useEffect)((function(){return v||w||!(n&&n.token&&n.apiKey)?null:p.rowsCount<0?(M(0===t),null):void 0}));var Q=[],B=[];return p.rows.forEach((function(e){console.log("conversion",e)})),Object(N.jsxs)(N.Fragment,{children:[w&&Object(N.jsxs)(f.a,{inverted:!0,color:"red",onClick:function(){return D(null)},children:[Object(N.jsx)(g.a,{onClick:function(){return D(null)},floated:"right",color:"red",icon:"close",size:"tiny",style:{marginTop:"-6px"}}),Object(N.jsx)("p",{children:w})]}),Object(N.jsxs)(f.a,{loading:v,style:{padding:"0",border:"0"},children:[Object(N.jsxs)(m.a,{attached:"top",children:[Object(N.jsxs)(m.a.Item,{children:[Object(N.jsx)(we.DateInput,{style:{width:"133px"},disabled:v,placeholder:"Date From",dateFormat:I,value:r.from,iconPosition:"left",maxDate:r.to,onChange:function(e,t){return c(Object(i.a)(Object(i.a)({},r),{},{from:t.value}))}}),Object(N.jsx)(we.DateInput,{style:{width:"133px",marginLeft:"5px"},disabled:v,placeholder:"Date To",dateFormat:I,value:r.to,iconPosition:"left",minDate:r.from,maxDate:He().format(I),onChange:function(e,t){return c(Object(i.a)(Object(i.a)({},r),{},{to:t.value}))}})]}),Object(N.jsx)(m.a.Item,{children:Object(N.jsx)(Se.a,{placeholder:"State",compact:!0,style:{width:"120px"},onChange:function(e,t){return V(t.value)},value:E,selection:!0,options:[{key:"all",text:"All",value:"all"},{key:"active",text:"Active",value:"active"},{key:"disabled",text:"Disabled",value:"disabled"},{key:"pending",text:"Pending",value:"pending"}]})}),Object(N.jsxs)(m.a.Menu,{position:"right",children:[Object(N.jsx)(m.a.Item,{children:Object(N.jsx)(C.a,{placeholder:"Search",style:{width:"240px"},value:s,onChange:function(e){return l(e.target.value)}})}),Object(N.jsxs)(m.a.Item,{disabled:v,onClick:function(){return M(!0)},children:[Object(N.jsx)(O.a,{name:"refresh",color:"violet"}),"Load Data"]}),Object(N.jsxs)(m.a.Item,{disabled:v,onClick:function(){return M()},children:[Object(N.jsx)(O.a,{name:"refresh",color:"blue"}),"Load Stats"]})]})]}),Object(N.jsxs)(F.a,{compact:!0,striped:!0,sortable:!0,celled:!0,selectable:!0,attached:"bottom",children:[Object(N.jsx)(F.a.Header,{children:Object(N.jsx)(F.a.Row,{children:Object(N.jsx)(_,{sort:z,onSort:function(e){T([e,z[0]===e&&!z[1]])},prop:"id",title:"ID"})})}),Object(N.jsx)(F.a.Body,{children:ge()(Q,z[0],z[1]?"asc":"desc").map((function(e){return B[e.bannerIndex]}))}),Object(N.jsx)(F.a.Footer,{children:Object(N.jsx)(F.a.Row,{children:Object(N.jsxs)(F.a.HeaderCell,{children:["Count: ",Q.length]})})})]})]})]})},Ee=Object(h.extendMoment)(b.a);var Ve=function(){var e=Date.now(),t=Object(a.useState)(!1),n=Object(o.a)(t,2),r=n[0],c=n[1],s=Object(a.useState)(null),l=Object(o.a)(s,2),u=l[0],p=l[1],b=Object(a.useState)(null),h=Object(o.a)(b,2),S=h[0],w=h[1],F=Object(a.useState)(!1),D=Object(o.a)(F,2),_=D[0],A=D[1],L=Object(a.useState)(!0),R=Object(o.a)(L,2),z=R[0],T=R[1],H=Object(a.useState)(0),P=Object(o.a)(H,2),E=P[0],V=P[1],M=Object(a.useState)("campaigns"),Q=Object(o.a)(M,2),B=Q[0],K=Q[1],$=Object(a.useState)(j.a.get("tsapp.auth")||{}),G=Object(o.a)($,2),U=G[0],Y=G[1],J=Object(a.useState)({from:Ee().format(I),to:Ee().format(I)}),q=Object(o.a)(J,2),W=q[0],X=q[1],Z=Object(a.useState)(""),ee=Object(o.a)(Z,2),te=ee[0],ne=ee[1];function ae(t){V(e),K(t)}Object(a.useEffect)((function(){return r||S||u?null:U.token?void 0:(_||A(!0),null)}),[r,u,U,S,_]);var re=d()((U.ttl-e)/1e3),ce=Ee.duration(re%3600>0?re:re-1,"seconds"),se=ce.get("minutes"),ie=ce.humanize(!0);return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)(m.a,{fluid:!0,attached:"top",inverted:!0,style:{borderRadius:"0"},children:[Object(N.jsx)(m.a.Item,{header:!0,children:"TSapp"}),Object(N.jsxs)(m.a.Item,{children:[Object(N.jsx)(O.a,{color:se>=30?"green":se>=8?"orange":"red",name:"key"}),"expires ",ie]}),U.clientId&&U.clientSecret&&U.tokenRefresh&&Object(N.jsxs)(m.a.Item,{disabled:r,onClick:function(){return function(){if(!(U.clientId&&U.clientSecret&&U.tokenRefresh))return null;c(!0),xe.authRefresh(U.clientId,U.clientSecret,U.tokenRefresh).then((function(e){var t=Object(i.a)(Object(i.a)({},U),e);z&&j.a.set("tsapp.auth",t),Y(t),c(!1)})).catch((function(e){Y(Object(i.a)(Object(i.a)({},U),{},{token:"",tokenRefresh:"",ttl:0})),w(e.toString()),c(!1)}))}()},children:[Object(N.jsx)(O.a,{name:"refresh",color:se>=8?null:"green"}),"Refresh token"]}),Object(N.jsxs)(m.a.Menu,{position:"right",children:[Object(N.jsxs)(m.a.Item,{disabled:r,active:"campaigns"===B,onClick:function(){return ae("campaigns")},children:[Object(N.jsx)(O.a,{name:"suitcase"}),"Campaigns"]}),Object(N.jsxs)(m.a.Item,{disabled:r,active:"banners"===B,onClick:function(){return ae("banners")},children:[Object(N.jsx)(O.a,{name:"picture"}),"Banners"]}),Object(N.jsxs)(m.a.Item,{disabled:r,active:"conversions"===B,onClick:function(){return ae("conversions")},children:[Object(N.jsx)(O.a,{name:"dollar"}),"Conversions"]})]})]}),Object(N.jsxs)(x.a,{className:"App",fluid:!0,style:{padding:"25px 25px 55px 25px"},children:[u&&Object(N.jsxs)(f.a,{inverted:!0,color:"red",onClick:function(){return p(null)},children:[Object(N.jsx)(g.a,{onClick:function(){return p(null)},floated:"right",color:"red",icon:"close",size:"tiny",style:{marginTop:"-6px"}}),Object(N.jsx)("p",{children:u})]}),"campaigns"===B&&Object(N.jsx)(Le,{switchStamp:E,auth:U,dates:W,setDates:X,searchQuery:te,setSearchQuery:ne}),"banners"===B&&Object(N.jsx)(Te,{switchStamp:E,auth:U,dates:W,setDates:X,searchQuery:te,setSearchQuery:ne}),"conversions"===B&&Object(N.jsx)(Pe,{switchStamp:E,auth:U,dates:W,setDates:X,searchQuery:te,setSearchQuery:ne})]}),Object(N.jsxs)(v.a,{open:_,children:[Object(N.jsx)(v.a.Header,{children:"Auth"}),Object(N.jsxs)(v.a.Content,{children:[S&&Object(N.jsxs)(f.a,{inverted:!0,color:"red",onClick:function(){return w(null)},children:[Object(N.jsx)(g.a,{onClick:function(){return w(null)},floated:"right",color:"red",icon:"close",size:"tiny",style:{marginTop:"-6px"}}),Object(N.jsx)("p",{children:S})]}),Object(N.jsxs)(y.a,{children:[Object(N.jsxs)(y.a.Field,{children:[Object(N.jsx)("label",{children:"TS client ID"}),Object(N.jsx)(C.a,{placeholder:"TS client ID",value:U.clientId||"",onChange:function(e){return Y(Object(i.a)(Object(i.a)({},U),{},{clientId:e.target.value}))}})]}),Object(N.jsxs)(y.a.Field,{children:[Object(N.jsx)("label",{children:"TS client Secret"}),Object(N.jsx)(C.a,{placeholder:"TS client Secret",value:U.clientSecret||"",onChange:function(e){return Y(Object(i.a)(Object(i.a)({},U),{},{clientSecret:e.target.value}))}})]}),Object(N.jsxs)(y.a.Field,{children:[Object(N.jsx)("label",{children:"CD api Key"}),Object(N.jsx)(C.a,{placeholder:"CD api Key",value:U.apiKey||"",onChange:function(e){return Y(Object(i.a)(Object(i.a)({},U),{},{apiKey:e.target.value}))}})]}),Object(N.jsxs)(y.a.Field,{children:[Object(N.jsx)("label",{children:"Login"}),Object(N.jsx)(C.a,{placeholder:"Login",value:U.login||"",onChange:function(e){return Y(Object(i.a)(Object(i.a)({},U),{},{login:e.target.value}))}})]}),Object(N.jsxs)(y.a.Field,{children:[Object(N.jsx)("label",{children:"Password"}),Object(N.jsx)(C.a,{type:"password",placeholder:"Password",value:U.password||"",onChange:function(e){return Y(Object(i.a)(Object(i.a)({},U),{},{password:e.target.value}))}})]}),Object(N.jsx)(y.a.Field,{children:Object(N.jsx)(k.a,{checked:!!z,onChange:function(){return T(!z)},label:"Save credentials in local storage"})})]})]}),Object(N.jsx)(v.a.Actions,{children:Object(N.jsx)(g.a,{type:"submit",color:"green",onClick:function(){return function(){if(!(U.clientId&&U.clientSecret&&U.login&&U.password))return Y(Object(i.a)(Object(i.a)({},U),{},{tokenRefresh:""})),null;c(!0),xe.auth(U.clientId,U.clientSecret,U.login,U.password).then((function(e){var t=Object(i.a)(Object(i.a)({},U),e);z&&j.a.set("tsapp.auth",t),Y(t),t.token&&A(!1),c(!1)})).catch((function(e){Y(Object(i.a)(Object(i.a)({},U),{},{tokenRefresh:""})),w(e.toString()),c(!1)}))}()},children:"Auth"})})]})]})},Me=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,605)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};s.a.render(Object(N.jsx)(r.a.StrictMode,{children:Object(N.jsx)(Ve,{})}),document.getElementById("root")),Me()}},[[547,1,2]]]);
//# sourceMappingURL=main.41dfa4ec.chunk.js.map