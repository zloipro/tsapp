{"version":3,"sources":["utils.js","store.js","api.js","components/Statistics/index.js","components/Campaigns/index.js","components/Banners/index.js","components/Conversions/index.js","components/App/index.js","reportWebVitals.js","index.js"],"names":["DATE_FORMAT","roundFixedView","value","fix","v","round","toFixed","style","opacity","repeat","TableHeaderCell","props","prop","title","collapsing","sort","onSort","Table","HeaderCell","onClick","calcStatsCtr","impressions","clicks","calcStatsCr","leads","calcStatsEcpc","price","calcStatsEcpa","calcStatsRevenue","income","calcStatsRoi","revenue","dataIndex","store","get","statsIndex","reportsIndex","saveStore","set","campaigns","creatives","adspots","urls","conversions","campaingsList","ttl","lastSync","campaingsCreatives","campaingsCreativesStats","campaingsAdspotsStats","creativeStats","moment","extendMoment","Moment","API_DEFAULT_SIZE","API_HEADERS","clientId","clientSecret","login","password","a","now","Date","axios","method","mode","url","headers","responseType","data","qs","stringify","grant_type","client_id","client_secret","username","changeOrigin","response","token","access_token","tokenRefresh","refresh_token","expires_in","getCampaigns","Authorization","params","size","length","forEach","campaign","id","active","status","pending","rejected","getCampaignCreatives","campaign_id","creative","image","includes","push","urlData","Promise","map","Object","entries","concurrency","getCampaignCreativesStats","campaignId","dateFrom","dateTo","dates","Array","from","range","by","d","format","reportKey","add","date_from","date_to","stats","banner_id","getCampaignAdspotsStats","spot_id","getCreativesStats","put","apiKey","affiliateId","crossdomain","console","log","apiModule","auth","authRefresh","getCampaignsAndCreatives","runCampaign","pauseCampaign","runCreative","pauseCreative","getConversions","getImageUrl","imageUrl","Statistics","textAlign","isNumber","Statistic","marginRight","Value","toLocaleString","Label","ctr","cr","ecpc","ecpa","color","roi","Placeholder","fluid","Paragraph","Line","Campaigns","switchStamp","setDates","searchQuery","setSearchQuery","useState","rows","rowsCount","state","setState","loading","setLoading","loadingError","setLoadingError","opened","setOpened","selected","setSelected","storeCampaignsFilter","sortProp","setSortProp","filterState","setFilterState","loadData","fullLoad","all","api","to","resolve","then","catch","error","errMsg","toString","onOpen","onSelect","campaignRun","campaignPause","creativeRun","creativePause","useEffect","totalStats","filterDates","rowsSortIndexCounter","rowsSortIndex","$rows","indexOf","toLowerCase","name","$row","creativesCount","creativeId","date","stat","amount","lead_price","campaignIndex","Row","textDecoration","warning","Cell","className","Loader","inline","Checkbox","toggle","checked","cursor","countries","countryCode","Flag","positive","negative","orderBy","creativeUrls","filter","fontSize","Button","margin","padding","icon","slider","disabled","Popup","position","flowing","hoverable","trigger","Comment","Group","Avatar","href","alt","rel","target","src","Content","brandname","Text","marginBottom","headline","listStyle","Segment","inverted","floated","marginTop","border","Menu","attached","Item","width","placeholder","dateFormat","iconPosition","maxDate","onChange","e","marginLeft","minDate","Dropdown","compact","selection","options","key","text","Input","Icon","striped","sortable","celled","selectable","Header","Body","item","Footer","colSpan","Banners","storeBannersFilter","rowsIndex","q","bannerIndex","keys","banner","split","slice","join","Conversions","storeConversionsFilter","conversion","App","authError","setAuthError","authModal","setAuthModal","useLocalStore","setUseLocalStore","setViewSwitchStamp","viewSelect","setViewSelect","setAuth","inViewSelect","view","tokenTtlSeconds","tokenDuration","duration","tokenDurationMinutes","tokenDurationText","humanize","borderRadius","header","authData","onAuthRefresh","Container","Modal","open","Form","Field","type","label","Actions","onAuth","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.41dfa4ec.chunk.js","sourcesContent":["// import Promise from 'bluebird';\nimport round from 'lodash/round';\nimport repeat from 'lodash/repeat';\nimport React from 'react';\nimport { Table } from 'semantic-ui-react';\n\n\nexport const DEFAULT_ROUND = 6;\nexport const DATE_FORMAT = 'YYYY-MM-DD';\n\n\nexport function roundFixedView(value = 0, fix = 3) {\n  const v = round(value, fix);\n  return v !== 0 ? v.toFixed(fix) : <span style={{ opacity: '0.6' }}>0{fix > 0 ? '.' : ''}{repeat('0', fix)}</span>\n}\n\nexport function TableHeaderCell(props) {\n  const { prop, title, collapsing, style, sort, onSort } = props;\n  return (\n    <Table.HeaderCell onClick={() => onSort(prop)} style={style} collapsing={!!collapsing}>{title + (sort[0] === prop ? (!!sort[1] ? ' ' :  ' ') : '')}</Table.HeaderCell>\n  );\n}\n\n\nexport function calcStatsCtr(impressions = 0, clicks = 0) {\n  return (impressions > 0 && clicks > 0) ? round((clicks / impressions) * 100, DEFAULT_ROUND) : 0; // !!!\n}\n\nexport function calcStatsCr(clicks = 0, leads = 0) {\n  return (clicks > 0 && leads > 0) ? round((leads / clicks) * 100, DEFAULT_ROUND) : 0; // !!!\n}\n\nexport function calcStatsLtr(impressions = 0, leads = 0) {\n  return (impressions > 0 && leads > 0) ? round((leads / impressions) * 100, DEFAULT_ROUND) : 0; // !!!\n}\n\nexport function calcStatsEcpc(clicks = 0, price = 0) {\n  return (clicks > 0  && price > 0) ? round((price / clicks), DEFAULT_ROUND) : 0; // !!!\n}\n\nexport function calcStatsEcpa(leads = 0, price = 0) {\n  return (leads > 0  && price > 0) ? round((price / leads), DEFAULT_ROUND) : 0; // !!!\n}\n\nexport function calcStatsRevenue(leads = 0, price = 0, income = 0) {\n  return leads > 0 ? round(income - price, DEFAULT_ROUND) : -price; // !!!\n}\n\nexport function calcStatsRoi(impressions = 0, leads = 0, price = 0, revenue = 0) {\n  return (impressions > 0 && price > 0) ? (leads > 0 ? round(revenue / price * 100, DEFAULT_ROUND) : -100) : 0; // !!!\n}\n","import store from 'store';\n\n\nexport const dataIndex = store.get('tsapp.dataIndex') || {};\nexport const statsIndex = store.get('tsapp.statsIndex') || {};\nexport const reportsIndex = store.get('tsapp.reportsIndex') || {};\n\n\n/// Data Index\n\nif (!dataIndex.campaigns) {\n  dataIndex.campaigns = {};\n}\nif (!dataIndex.creatives) {\n  dataIndex.creatives = {};\n}\nif (!dataIndex.adspots) {\n  dataIndex.adspots = {};\n}\nif (!dataIndex.urls) {\n  dataIndex.urls = {};\n}\nif (!dataIndex.conversions) {\n  dataIndex.conversions = {};\n}\n\n\n\n/// Reports Index\n\nif (!reportsIndex.campaingsList) {\n  reportsIndex.campaingsList = {\n    ttl: 60,\n    lastSync: {},\n  };\n}\nif (!reportsIndex.campaingsCreatives) {\n  reportsIndex.campaingsCreatives = {\n    ttl: 60,\n    lastSync: {},\n  };\n}\nif (!reportsIndex.campaingsCreativesStats) {\n  reportsIndex.campaingsCreativesStats = {\n    ttl: 60,\n    lastSync: {},\n  };\n}\nif (!reportsIndex.campaingsAdspotsStats) {\n  reportsIndex.campaingsAdspotsStats = {\n    ttl: 600,\n    lastSync: {},\n  };\n}\nif (!reportsIndex.creativeStats) {\n  reportsIndex.creativeStats = {\n    ttl: 600,\n    lastSync: {},\n  };\n}\n\n\nexport function saveStore() {\n  store.set('tsapp.dataIndex', dataIndex);\n  store.set('tsapp.statsIndex', statsIndex);\n  store.set('tsapp.reportsIndex', reportsIndex);\n}\n","import Promise from 'bluebird';\nimport axios from 'axios';\nimport qs from 'qs';\nimport Moment from 'moment';\nimport { extendMoment } from 'moment-range';\nimport { DATE_FORMAT } from './utils';\nimport { dataIndex, statsIndex, reportsIndex } from './store';\nconst moment = extendMoment(Moment);\n\n\nconst API_BUCKET_BANNER = 'https://admin.trafficstars.com/media/';\nconst API_DEFAULT_SIZE = 200;\nconst API_HEADERS = {\n  // 'Access-Control-Allow-Origin': '*',\n  // 'Access-Control-Allow-Methods': 'GET,PUT,POST,DELETE',\n  // 'Access-Control-Allow-Headers': 'Content-Type',\n  'Content-Type': 'application/json',\n};\n\n\nasync function auth(clientId, clientSecret, login, password) {\n  const now = Date.now();\n  const response = await axios({\n    method: 'post',\n    mode: 'no-cors',\n    url: 'https://api.trafficstars.com/v1/auth/token',\n    headers: {\n      ...API_HEADERS,\n      'Content-Type': 'application/x-www-form-urlencoded'\n    },\n    responseType: 'json',\n    data: qs.stringify({\n      grant_type:     'password',\n      client_id:      clientId,\n      client_secret:  clientSecret,\n      username:       login,\n      password:       password,\n    }),\n    changeOrigin: true,\n  });\n  return {\n    token:        response.data.access_token,\n    tokenRefresh: response.data.refresh_token,\n    ttl:          now + (response.data.expires_in * 1e3),\n  };\n}\n\nasync function authRefresh(clientId, clientSecret, tokenRefresh) {\n  const now = Date.now();\n  const response = await axios({\n    method: 'post',\n    url: 'https://api.trafficstars.com/v1/auth/token',\n    headers: {\n      ...API_HEADERS,\n      'Content-Type': 'application/x-www-form-urlencoded'\n    },\n    responseType: 'json',\n    data: qs.stringify({\n      grant_type:     'refresh_token',\n      client_id:      clientId,\n      client_secret:  clientSecret,\n      refresh_token:  tokenRefresh,\n    }),\n    changeOrigin: true,\n  });\n  return {\n    token:        response.data.access_token,\n    tokenRefresh: response.data.refresh_token,\n    ttl:          now + (response.data.expires_in * 1e3),\n  };\n}\n\nasync function getCampaigns(token) {\n  const now = Date.now();\n  \n  const response = await axios.get('https://api.trafficstars.com/v1/campaign/list', {\n    responseType: 'json',\n    headers: {\n      ...API_HEADERS,\n      Authorization: 'bearer ' + token,\n    },\n    params: {\n      size: API_DEFAULT_SIZE,\n    },\n    changeOrigin: true,\n  });\n  \n  if (!(response.data.response && response.data.response.length)) {\n    return null;\n  }\n\n  response.data.response.forEach(campaign => {\n    dataIndex.campaigns[campaign.id] = {\n      ...campaign,\n      creatives: dataIndex.campaigns[campaign.id] ? (dataIndex.campaigns[campaign.id].creatives || []) : [],\n      active: campaign.status === 1,\n      pending: campaign.status === 0,\n      rejected: campaign.status === 4,\n      lastSync: now,\n    }\n  });\n}\n\nasync function getCampaignCreatives(token, campaign_id) {\n  const now = Date.now();\n  \n  const response = await axios.get('https://api.trafficstars.com/v1/banner/list', {\n    responseType: 'json',\n    headers: {\n      ...API_HEADERS,\n      Authorization: 'bearer ' + token,\n    },\n    params: {\n      campaign_id,\n      size: API_DEFAULT_SIZE,\n    },\n    changeOrigin: true,\n  });\n  \n  if (!(response.data.response && response.data.response.length)) {\n    return null;\n  }\n\n  response.data.response.forEach(creative => {\n    if (!(creative && creative.id && creative.campaign_id && creative.image)) {\n      return;\n    }\n    if (dataIndex.campaigns[creative.campaign_id]) {\n      if (!dataIndex.campaigns[creative.campaign_id].creatives) {\n        dataIndex.campaigns[creative.campaign_id].creatives = [creative.id];\n      } else {\n        if (!dataIndex.campaigns[creative.campaign_id].creatives.includes(creative.id)) {\n          dataIndex.campaigns[creative.campaign_id].creatives.push(creative.id);\n        }\n      }\n    }\n    dataIndex.creatives[creative.id] = {\n      ...creative,\n      active: creative.status === 1,\n      pending: creative.status === 0,\n      rejected: creative.status === 4,\n      lastSync: now,\n    };\n    dataIndex.urls = {};\n    if (creative.urls && creative.urls.length) {\n      creative.urls.forEach(urlData => {\n        if (!(urlData && urlData.id && urlData.url)) {\n          return null;\n        }\n        dataIndex.urls[urlData.url] = urlData;\n      });\n    }\n  });\n}\n\nasync function getCampaignsAndCreatives(token) {\n  await getCampaigns(token);\n  await Promise.map(Object.entries(dataIndex.campaigns), ([id]) => getCampaignCreatives(token, id), { concurrency: 6 });\n}\n\nasync function getCampaignCreativesStats(token, campaignId, dateFrom, dateTo) {\n  const now = Date.now();\n  \n  if (dateTo && dateFrom !== dateTo) {\n    const dates = Array.from(moment.range(moment(dateFrom, DATE_FORMAT), moment(dateTo, DATE_FORMAT)).by('day')).map(d => d.format(DATE_FORMAT));\n    await Promise.map(dates, d => getCampaignCreativesStats(token, campaignId, d), { concurrency: 1 })\n    return null;\n  }\n  \n  const reportKey = (dateFrom === moment().format(DATE_FORMAT) || dateFrom === moment().add(1, 'd').format(DATE_FORMAT)) ? null : (campaignId + '-' + dateFrom);\n  if (reportKey && reportsIndex.campaingsCreativesStats.lastSync[reportKey] && ((reportsIndex.campaingsCreativesStats.lastSync[reportKey] + reportsIndex.campaingsCreativesStats.ttl * 1e3) >= now)) {\n    return;\n  }\n\n  const response = await axios.get('https://api.trafficstars.com/v1.1/advertiser/custom/report/by-creative', {\n    responseType: 'json',\n    headers: {\n      ...API_HEADERS,\n      Authorization: 'bearer ' + token,\n    },\n    params: {\n      campaign_id:  campaignId,\n      date_from:    dateFrom,\n      date_to:      dateFrom,\n    },\n    changeOrigin: true,\n  });\n\n  if (!(response.data && response.data.length)) {\n    return null;\n  }\n\n  if (!statsIndex[dateFrom]) {\n    statsIndex[dateFrom] = {\n      campaigns: {},\n      creatives: {},\n      adspots: {},\n    };\n  }\n\n  response.data.forEach(stats => {\n    if (stats && stats.banner_id) {\n      // console.log(stats);\n      statsIndex[dateFrom].creatives[stats.banner_id] = {\n        ...stats,\n        lastSync: now,\n      };\n    }\n  });\n\n  if (reportKey) {\n    reportsIndex.campaingsCreativesStats.lastSync[reportKey] = now;\n  }\n}\n\nasync function getCampaignAdspotsStats(token, campaignId, dateFrom, dateTo) {\n  const now = Date.now();\n  if (dateTo && dateFrom !== dateTo) {\n    const dates = Array.from(moment.range(moment(dateFrom, DATE_FORMAT), moment(dateTo, DATE_FORMAT)).by('day')).map(d => d.format(DATE_FORMAT));\n    await Promise.map(dates, d => getCampaignAdspotsStats(token, campaignId, d), { concurrency: 1 })\n    return null;\n  }\n  \n  const reportKey = (dateFrom === moment().format(DATE_FORMAT) || dateFrom === moment().add(1, 'd').format(DATE_FORMAT)) ? null : (campaignId + '-' + dateFrom);\n  if (reportKey && reportsIndex.campaingsAdspotsStats.lastSync[reportKey] && ((reportsIndex.campaingsAdspotsStats.lastSync[reportKey] + reportsIndex.campaingsAdspotsStats.ttl * 1e3) >= now)) {\n    return;\n  }\n\n  const response = await axios.get('https://api.trafficstars.com/v1.1/advertiser/custom/report/by-spot', {\n    responseType: 'json',\n    headers: {\n      ...API_HEADERS,\n      Authorization: 'bearer ' + token,\n    },\n    params: {\n      campaign_id:  campaignId,\n      date_from:    dateFrom,\n      date_to:      dateFrom,\n    },\n    changeOrigin: true,\n  });\n\n  if (!statsIndex[dateFrom]) {\n    statsIndex[dateFrom] = {\n      campaigns: {},\n      creatives: {},\n      adspots: {},\n    };\n  }\n\n  response.data.forEach(stats => {\n    if (stats && stats.spot_id) {\n      // console.log(stats);\n      statsIndex[dateFrom].adspots[stats.spot_id] = {\n        ...stats,\n        lastSync: now,\n      };\n    }\n  });\n\n  if (reportKey) {\n    reportsIndex.campaingsAdspotsStats.lastSync[reportKey] = now;\n  }\n}\n\nasync function getCreativesStats(token, dateFrom, dateTo) {\n  const now = Date.now();\n  if (dateTo && dateFrom !== dateTo) {\n    const dates = Array.from(moment.range(moment(dateFrom, DATE_FORMAT), moment(dateTo, DATE_FORMAT)).by('day')).map(d => d.format(DATE_FORMAT));\n    await Promise.map(dates, d => getCreativesStats(token, d), { concurrency: 1 })\n    return null;\n  }\n  \n  const reportKey = (dateFrom === moment().format(DATE_FORMAT) || dateFrom === moment().add(1, 'd').format(DATE_FORMAT)) ? null : (dateFrom);\n  if (reportKey && reportsIndex.creativeStats.lastSync[reportKey] && ((reportsIndex.creativeStats.lastSync[reportKey] + reportsIndex.creativeStats.ttl * 1e3) >= now)) {\n    return null;\n  }\n\n  const response = await axios.get(`https://api.trafficstars.com/v1.1/advertiser/custom/report/by-creative`, {\n    responseType: 'json',\n    headers: {\n      ...API_HEADERS,\n      Authorization: 'bearer ' + token,\n    },\n    params: {\n      date_from:    dateFrom,\n      date_to:      dateFrom,\n    },\n    changeOrigin: true,\n  });\n  \n  if (!(response.data && response.data.length)) {\n    return null;\n  }\n  \n  if (!statsIndex[dateFrom]) {\n    statsIndex[dateFrom] = {\n      campaigns: {},\n      creatives: {},\n      adspots: {},\n    };\n  }\n\n  response.data.forEach(stats => {\n    if (stats && stats.banner_id) {\n      // console.log(stats);\n      statsIndex[dateFrom].creatives[stats.banner_id] = {\n        ...stats,\n        lastSync: now,\n      };\n    }\n  });\n\n  if (reportKey) {\n    reportsIndex.creativeStats.lastSync[reportKey] = now;\n  }\n}\n\nasync function runCampaign(token, id) {\n  const now = Date.now();\n  const response = await axios.put(`https://api.trafficstars.com/v1/campaign/${id}/run`, {}, {\n    headers: {\n      ...API_HEADERS,\n      Authorization: 'bearer ' + token,\n    },\n    changeOrigin: true,\n  });\n\n  const campaign = response.data;\n  if (campaign && campaign.id) {\n    dataIndex.campaigns[campaign.id] = {\n      ...campaign,\n      active: campaign.status === 1,\n      pending: campaign.status === 0,\n      rejected: campaign.status === 4,\n      lastSync: now,\n    };\n  }\n}\n\nasync function pauseCampaign(token, id) {\n  const now = Date.now();\n  const response = await axios.put(`https://api.trafficstars.com/v1/campaign/${id}/pause`, {}, {\n    headers: {\n      ...API_HEADERS,\n      Authorization: 'bearer ' + token,\n    },\n    changeOrigin: true,\n  });\n\n  const campaign = response.data;\n  if (campaign && campaign.id) {\n    dataIndex.campaigns[campaign.id] = {\n      ...campaign,\n      active: campaign.status === 1,\n      pending: campaign.status === 0,\n      rejected: campaign.status === 4,\n      lastSync: now,\n    };\n  }\n}\n\nasync function runCreative(token, id) {\n  const now = Date.now();\n  const response = await axios.put(`https://api.trafficstars.com/v1/banner/${id}/run`, {}, {\n    headers: {\n      ...API_HEADERS,\n      Authorization: 'bearer ' + token,\n    },\n    changeOrigin: true,\n  });\n  \n  const creative = response.data.response;\n  if (creative && creative.id) {\n    dataIndex.creatives[creative.id] = {\n      ...creative,\n      active: creative.status === 1,\n      pending: creative.status === 0,\n      rejected: creative.status === 4,\n      lastSync: now,\n    };\n  }\n}\n\nasync function pauseCreative(token, id) {\n  const now = Date.now();\n  const response = await axios.put(`https://api.trafficstars.com/v1/banner/${id}/pause`, {}, {\n    headers: {\n      ...API_HEADERS,\n      Authorization: 'bearer ' + token,\n    },\n    changeOrigin: true,\n  });\n  \n  const creative = response.data.response;\n  if (creative && creative.id) {\n    dataIndex.creatives[creative.id] = {\n      ...creative,\n      active: creative.status === 1,\n      pending: creative.status === 0,\n      rejected: creative.status === 4,\n      lastSync: now,\n    };\n  }\n}\n\nasync function getConversions(apiKey, affiliateId, dateFrom, dateTo) {\n  const response = await axios(`https://partners.clickdealer.com/affiliates/api/1/reports.asmx/Conversions?api_key=${apiKey}&affiliate_id=142387&start_date=10%2F24%2F2021%2000%3A00%3A00&end_date=10%2F25%2F2021%2023%3A59%3A59&include_tests=False&row_limit=100&currency_id=All&disposition_type=All&conversion_type=All&update_filter=False`, {\n    // responseType: 'json',\n    method: 'GET',\n    headers: {\n      ...API_HEADERS,\n    },\n    // params: {\n    //   date_from:    dateFrom,\n    //   date_to:      dateFrom,\n    // },\n    // changeOrigin: true,\n    mode: 'no-cors',\n    crossdomain: true,\n  });\n  console.log(response);\n}\n\nfunction getImageUrl(imageUrl) {\n  return API_BUCKET_BANNER + imageUrl;\n}\n\nconst apiModule = {\n  auth,\n  authRefresh,\n  getCampaigns,\n  getCampaignCreatives,\n  getCampaignsAndCreatives,\n  getCampaignCreativesStats,\n  getCampaignAdspotsStats,\n  getCreativesStats,\n  runCampaign,\n  pauseCampaign,\n  runCreative,\n  pauseCreative,\n  getConversions,\n  getImageUrl,\n};\n\nexport default apiModule;\n","import React from 'react';\nimport isNumber from 'lodash/isNumber';\nimport { Statistic, Placeholder } from 'semantic-ui-react';\nimport './style.scss';\n\n\nfunction Statistics(props) {\n  const { stats } = props;\n\n  if (!stats) {\n    return (\n      <div style={{ textAlign: 'center' }}>\n        <Placeholder fluid>\n          <Placeholder.Paragraph>\n            <Placeholder.Line />\n            <Placeholder.Line />\n            <Placeholder.Line />\n            <Placeholder.Line />\n          </Placeholder.Paragraph>\n        </Placeholder>\n      </div>\n    );\n  }\n\n  return (\n    <div style={{ textAlign: 'center' }}>\n      {isNumber(stats.impressions) && <Statistic size='mini' style={{ marginRight: '20px' }}>\n        <Statistic.Value>{stats.impressions.toLocaleString()}</Statistic.Value>\n        <Statistic.Label>Impressions</Statistic.Label>\n      </Statistic>}\n      {isNumber(stats.clicks) && <Statistic size='mini' style={{ marginRight: '20px' }}>\n        <Statistic.Value>{stats.clicks.toLocaleString()}</Statistic.Value>\n        <Statistic.Label>Clicks</Statistic.Label>\n      </Statistic>}\n      {isNumber(stats.leads) && <Statistic size='mini' style={{ marginRight: '20px' }}>\n        <Statistic.Value>{stats.leads.toLocaleString()}</Statistic.Value>\n        <Statistic.Label>Leads</Statistic.Label>\n      </Statistic>}\n      {isNumber(stats.ctr) && <Statistic size='mini' style={{ marginRight: '20px' }}>\n        <Statistic.Value>{stats.ctr.toFixed(3)}%</Statistic.Value>\n        <Statistic.Label>CTR</Statistic.Label>\n      </Statistic>}\n      {isNumber(stats.cr) && <Statistic size='mini' style={{ marginRight: '20px' }}>\n        <Statistic.Value>{stats.cr.toFixed(3)}%</Statistic.Value>\n        <Statistic.Label>CR</Statistic.Label>\n      </Statistic>}\n      {isNumber(stats.ecpc) && <Statistic size='mini' style={{ marginRight: '20px' }}>\n        <Statistic.Value>{stats.ecpc.toFixed(3)}$</Statistic.Value>\n        <Statistic.Label>ECPC</Statistic.Label>\n      </Statistic>}\n      {isNumber(stats.ecpa) && <Statistic size='mini' style={{ marginRight: '20px' }}>\n        <Statistic.Value>{stats.ecpa.toFixed(3)}$</Statistic.Value>\n        <Statistic.Label>ECPA</Statistic.Label>\n      </Statistic>}\n      {isNumber(stats.price) && <Statistic size='mini' style={{ marginRight: '20px' }}>\n        <Statistic.Value>{stats.price.toFixed(3).toLocaleString()}$</Statistic.Value>\n        <Statistic.Label>Price</Statistic.Label>\n      </Statistic>}\n      {isNumber(stats.income) && <Statistic size='mini' style={{ marginRight: '20px' }} color={stats.income > 0 ? 'green' : 'red'}>\n        <Statistic.Value>{stats.income.toFixed(3).toLocaleString()}$</Statistic.Value>\n        <Statistic.Label>Income</Statistic.Label>\n      </Statistic>}\n      {isNumber(stats.revenue) && <Statistic size='mini' style={{ marginRight: '20px' }} color={stats.revenue > 0 ? 'green' : 'red'}>\n        <Statistic.Value>{stats.revenue.toFixed(3).toLocaleString()}$</Statistic.Value>\n        <Statistic.Label>Revenue</Statistic.Label>\n      </Statistic>}\n      {isNumber(stats.roi) && <Statistic size='mini' color={stats.roi > 16 ? 'green' : (stats.roi > 0 ? 'orange' : 'red')}>\n        <Statistic.Value>{stats.roi.toFixed(3)}%</Statistic.Value>\n        <Statistic.Label>ROI</Statistic.Label>\n      </Statistic>}\n    </div>\n  );\n}\n\nexport default Statistics;\n","import Promise from 'bluebird';\nimport React, { useState, useEffect } from 'react';\nimport round from 'lodash/round';\nimport orderBy from 'lodash/orderBy';\nimport store from 'store';\nimport Moment from 'moment';\nimport { extendMoment } from 'moment-range';\nimport { Segment, Button, Table, Popup, Checkbox, Loader, Comment, Menu, Icon, Input, Dropdown, Flag } from 'semantic-ui-react';\nimport { DateInput } from 'semantic-ui-calendar-react';\nimport {\n  DATE_FORMAT,\n  roundFixedView, TableHeaderCell,\n  calcStatsCtr, calcStatsCr, calcStatsEcpc, calcStatsEcpa, calcStatsRevenue, calcStatsRoi,\n} from '../../utils';\nimport { dataIndex, statsIndex, saveStore } from '../../store';\nimport api  from '../../api';\nimport './style.scss';\nimport Statistics from '../Statistics';\nconst moment = extendMoment(Moment);\n\n\nfunction Campaigns(props = {}) {\n  // const now = Date.now();\n  const {\n    switchStamp,\n    auth,\n    dates, setDates,\n    searchQuery, setSearchQuery,\n  } = props;\n  const [state, setState] = useState({\n    rows: [],\n    rowsCount: -1,\n  });\n\n  const [loading, setLoading] = useState(false);\n  const [loadingError, setLoadingError] = useState(null);\n  const [opened, setOpened] = useState({});\n  const [selected, setSelected] = useState({});\n  const storeCampaignsFilter = store.get('tsapp.campaigns.filter') || {};\n  const [sortProp, setSortProp] = useState([storeCampaignsFilter['sortProp'] || 'cr', storeCampaignsFilter['sortValue'] || false]);\n  const [filterState, setFilterState] = useState('all');\n\n  function loadData(fullLoad = false) {\n    setLoading(true);\n    (!!fullLoad\n      ? Promise.all([\n          api.getCampaignsAndCreatives(auth.token),\n          api.getCreativesStats(auth.token, dates.from, dates.to),\n        ])\n      : Promise.all([\n          Promise.resolve(Object.entries(dataIndex.campaigns).map(([id, campaign]) => campaign)),\n          api.getCreativesStats(auth.token, dates.from, dates.to),\n        ])\n    )\n      .then(async function () {\n        const campaigns = Object.entries(dataIndex.campaigns).map(([id, campaign]) => campaign);\n        if (campaigns.length) {\n          // console.log(statsIndex);\n          saveStore();\n        }\n        setState({\n          rows: campaigns,\n          rowsCount: campaigns.length,\n        });\n        setLoading(false);\n      })\n      .catch(function (error) {\n        console.error(error);\n        setState({\n          rows: [],\n          rowsCount: -1,\n        });\n        const errMsg = error.toString();\n        setLoadingError(errMsg);\n        setLoading(false);\n      });\n  }\n\n  // useEffect(() => {\n  //   console.log('campaigns mounted', switchStamp);\n  //   if (componentGlobalTimeout) {\n  //     console.log('componentGlobalTimeout', 0);\n  //   } else {\n  //     componentGlobalTimeout = setTimeout(() => {\n  //       console.log('componentGlobalTimeout', 1);\n  //       componentGlobalTimeout = null;\n  //     }, 1e3)\n  //   }\n  // },[]);\n\n  useEffect(() => {\n    if (loading || loadingError || !(auth && auth.token)) {\n      return null;\n    }\n    if (state.rowsCount < 0) {\n      loadData(switchStamp === 0);\n      return null;\n    }\n  });\n\n  function onSort(prop) {\n    setSortProp([prop, sortProp[0] === prop ? !sortProp[1] : false]);\n  }\n\n  function onOpen(id) {\n    if (opened[id]) {\n      delete opened[id];\n    } else {\n      opened[id] = true;\n    }\n    setOpened({\n      ...opened,\n    });\n  }\n\n  function onSelect(id) {\n    if (selected[id]) {\n      delete selected[id];\n    } else {\n      selected[id] = true;\n    }\n    setSelected({\n      ...selected,\n    });\n  }\n\n  function campaignRun(id) {\n    setLoading(true);\n    api.runCampaign(auth.token, id)\n      .then(() => loadData(true))\n      .catch((error) => {\n        setLoadingError(error.toString());\n        setLoading(false);\n      })\n  }\n\n  function campaignPause(id) {\n    setLoading(true);\n    api.pauseCampaign(auth.token, id)\n      .then(() => loadData(true))\n      .catch((error) => {\n        setLoadingError(error.toString());\n        setLoading(false);\n      })\n  }\n\n  function creativeRun(id) {\n    setLoading(true);\n    api.runCreative(auth.token, id)\n      .then(() => loadData(true))\n      .catch((error) => {\n        setLoadingError(error.toString());\n        setLoading(false);\n      })\n  }\n\n  function creativePause(id) {\n    setLoading(true);\n    api.pauseCreative(auth.token, id)\n      .then(() => loadData(true))\n      .catch((error) => {\n        setLoadingError(error.toString());\n        setLoading(false);\n      })\n  }\n\n  let totalStats = {\n    impressions:  0,\n    clicks:       0,\n    leads:        0,\n    price:        0,\n    income:       0,\n    ctr:          0,\n    cr:           0,\n    ecpc:         0,\n    ecpa:         0,\n    revenue:      0,\n    roi:          0,\n  };\n  \n  const filterDates = Array.from(moment.range(moment(dates.from, DATE_FORMAT), moment(dates.to, DATE_FORMAT)).by('day')).map(d => d.format(DATE_FORMAT));\n  let  rowsSortIndexCounter = 0;\n  const rowsSortIndex = [];\n  const $rows = [];\n  if (state && state.rows && state.rows.length) state.rows.forEach((campaign) => {\n    switch(filterState) {\n      case 'active':\n      case 'active-all':\n        if (!campaign.active) return null;\n        break;\n      case 'disabled':\n        if (campaign.active) return null;\n        break;\n      case 'pending':\n        if (!campaign.pending) return null;\n        break;\n      default:\n    }\n    if (searchQuery) {\n      if (\n        !~((campaign.id + '').indexOf(searchQuery.toLowerCase())) &&\n        !~(campaign.name.toLowerCase()).indexOf(searchQuery.toLowerCase())\n      ) {\n        return null;\n      }\n    }\n    const $row = [];\n    const campaingsCreatives = [];\n    const creativesCount = (campaign && campaign.creatives && campaign.creatives.length) ? campaign.creatives.length : 0;\n\n    campaign.impressions = 0;\n    campaign.clicks      = 0;\n    campaign.leads       = 0;\n    campaign.price       = 0;\n    campaign.income      = 0;\n\n    if (creativesCount > 0) campaign.creatives.forEach(creativeId => {\n      const creative = dataIndex.creatives[creativeId];\n      if (!creative) {\n        return null;\n      }\n      switch(filterState) {\n        case 'active-all':\n          if (!creative.active) return null;\n          break;\n        default:\n      }\n      creative.impressions = 0;\n      creative.clicks      = 0;\n      creative.leads       = 0;\n      creative.price       = 0;\n      creative.income      = 0;\n\n      filterDates.forEach(date => {\n        if (!(statsIndex[date] && statsIndex[date].creatives[creativeId])) {\n          return null;\n        }\n        const stat = statsIndex[date].creatives[creativeId];\n        creative.impressions += stat.impressions;\n        creative.clicks      += stat.clicks;\n        creative.leads       += stat.leads;\n        creative.price       += stat.amount;\n        creative.income      += stat.lead_price;\n      });\n\n      if (!selected['b-' + creativeId]) {\n        campaign.impressions += creative.impressions;\n        campaign.clicks      += creative.clicks;\n        campaign.leads       += creative.leads;\n        campaign.price       += creative.price;\n        campaign.income      += creative.income;\n      }\n\n      creative.ctr     = calcStatsCtr(creative.impressions, creative.clicks);\n      creative.cr      = calcStatsCr(creative.clicks, creative.leads);\n      creative.ecpc    = calcStatsEcpc(creative.clicks, creative.price);\n      creative.ecpa    = calcStatsEcpa(creative.leads, creative.price);\n      creative.revenue = calcStatsRevenue(creative.impressions, creative.price, creative.income);\n      creative.roi     = calcStatsRoi(creative.impressions, creative.leads, creative.price, creative.revenue);\n      \n      campaingsCreatives.push(creative);\n    });\n\n    campaign.ctr     = calcStatsCtr(campaign.impressions, campaign.clicks);\n    campaign.cr      = calcStatsCr(campaign.clicks, campaign.leads);\n    campaign.ecpc    = calcStatsEcpc(campaign.clicks, campaign.price);\n    campaign.ecpa    = calcStatsEcpa(campaign.leads, campaign.price);\n    campaign.revenue = calcStatsRevenue(campaign.leads, campaign.price, campaign.income);\n    campaign.roi     = calcStatsRoi(campaign.impressions, campaign.leads, campaign.price, campaign.revenue);\n\n    rowsSortIndex.push({\n      ...campaign,\n      campaignIndex:  rowsSortIndexCounter++,\n    });\n    \n    if (!selected['c-' + campaign.id]) {\n      totalStats.impressions += campaign.impressions;\n      totalStats.clicks      += campaign.clicks;\n      totalStats.leads       += campaign.leads;\n      totalStats.price       += campaign.price\n      totalStats.income      += campaign.income;\n    }\n\n    $row.push(\n      <Table.Row key={'campaign-' + campaign.id} style={{ textDecoration: !!selected['c-' + campaign.id] ? 'line-through' : ''  }} warning={!campaign.active || campaign.pending} active={!!opened['c-' + campaign.id]}>\n        <Table.Cell className='tac'>\n          {(campaign.pending)\n            ? <Loader active inline size='mini'/>\n            : <Checkbox toggle checked={!!campaign.active} onClick={() => !!campaign.active ? campaignPause(campaign.id) : campaignRun(campaign.id) } />\n          }\n        </Table.Cell>\n        <Table.Cell className='monoFont' style={{ cursor: creativesCount && 'pointer' }} onClick={() => creativesCount && onOpen('c-' + campaign.id)}>{campaign.id}</Table.Cell>\n        <Table.Cell className='monoFont' style={{ cursor: creativesCount && 'pointer' }} onClick={() => creativesCount && onOpen('c-' + campaign.id)}>\n          {(campaign && campaign.countries && campaign.countries.length > 0) && campaign.countries.map(countryCode => (<Flag key={'countryCode-' + countryCode} name={countryCode.toLowerCase()} />))}\n          {creativesCount ? <b>{campaign.name}</b> : campaign.name}\n        </Table.Cell>\n        <Table.Cell className='tar monoFont'>{roundFixedView(campaign.impressions / 1000, 3)}</Table.Cell>\n        <Table.Cell className='tar monoFont'>{roundFixedView(campaign.clicks, 0)}</Table.Cell>\n        <Table.Cell className='tar monoFont'>{roundFixedView(campaign.leads, 0)}</Table.Cell>\n        <Table.Cell className='tar monoFont'>{roundFixedView(campaign.ctr, 2)}</Table.Cell>\n        <Table.Cell className='tar monoFont'>{roundFixedView(campaign.cr, 2)}</Table.Cell>\n        <Table.Cell className='tar monoFont'>{roundFixedView(campaign.price, 3)}</Table.Cell>\n        <Table.Cell className='tar monoFont'>{roundFixedView(campaign.income, 3)}</Table.Cell>\n        <Table.Cell className='tar monoFont' positive={campaign.revenue > 0} negative={campaign.revenue < 0}>{campaign.revenue > 0 ? '+' : ''}{roundFixedView(campaign.revenue, 3)}</Table.Cell>\n        <Table.Cell className='tar monoFont' style={{ cursor: 'pointer' }} positive={campaign.roi > 0} negative={campaign.roi < 0} onClick={() => onSelect('c-' + campaign.id)}>{campaign.roi > 0 ? '+' : ''}{roundFixedView(campaign.roi, 2)}</Table.Cell>\n      </Table.Row>\n    );\n\n    if (creativesCount && opened['c-' + campaign.id]) {\n      orderBy(campaingsCreatives, sortProp[0], !!sortProp[1] ? 'asc' : 'desc').forEach(creative => {\n        const creativeUrls = creative.urls.filter(urlData => urlData && (urlData.status === 1) && urlData.id && urlData.url);\n        const imageUrl = api.getImageUrl(creative.image);\n        $row.push(\n          <Table.Row key={'campaign-' + campaign.id + '-creative-' + creative.id} warning={!creative.active || creative.pending} style={{ fontSize: '0.8em', textDecoration: !!(selected['b-' + creative.id]) ? 'line-through' : '' }}>\n            <Table.Cell className='tac'>\n              {(creative.pending) ? <Loader active inline size='mini'/>\n                : ((creative.rejected) ? <Button color='red' style={{ margin: '0 5px 0 0', padding: '2px' }} size='tiny' icon='warning'/>\n                  : <Checkbox slider disabled={!(campaign && campaign.active)}  checked={!!(campaign && campaign.active && creative.active)} onClick={() => (campaign && campaign.active && creative.active) ? creativePause(creative.id) : creativeRun(creative.id) } />\n                )\n              }\n            </Table.Cell>\n            <Table.Cell className='monoFont'>{''}&thinsp;{creative.id}</Table.Cell>\n            <Table.Cell className='monoFont'>\n              <Popup position='right center' flowing hoverable trigger={<Button color='blue' style={{ margin: '0 5px 0 0', padding: '2px' }} size='tiny' icon='image' />}>\n                <Comment.Group>\n                  <Comment>\n                    <Comment.Avatar href={imageUrl} title={imageUrl} alt={imageUrl} rel='noreferrer' target='_blank' src={imageUrl} />\n                    <Comment.Content>\n                      <span className='author'>{creative.brandname}</span>\n                      <Comment.Text style={{ margin: '0', padding: '0' }}>\n                        <p style={{ marginBottom: '3px' }}>{creative.headline}</p>\n                        {creativeUrls.length > 0 && (\n                          <ul style={{ margin: '0', padding: '0' }}>\n                            {creativeUrls.map(urlData => (\n                              <li key={urlData} style={{ listStyle: 'none' }}>\n                                <a href={urlData.url} title={urlData.url} alt={urlData.url} rel='noreferrer' target='_blank'>{urlData.id}</a>\n                              </li>\n                            ))}\n                          </ul>\n                        )}\n                      </Comment.Text>\n                    </Comment.Content>\n                  </Comment>\n                </Comment.Group>\n              </Popup>\n              {creative.brandname}\n            </Table.Cell>\n            <Table.Cell className='tar monoFont'>{roundFixedView(creative.impressions / 1000, 3)}</Table.Cell>\n            <Table.Cell className='tar monoFont'>{roundFixedView(creative.clicks, 0)}</Table.Cell>\n            <Table.Cell className='tar monoFont'>{roundFixedView(creative.leads, 0)}</Table.Cell>\n            <Table.Cell className='tar monoFont'>{roundFixedView(creative.ctr, 2)}</Table.Cell>\n            <Table.Cell className='tar monoFont'>{roundFixedView(creative.cr, 2)}</Table.Cell>\n            <Table.Cell className='tar monoFont'>{roundFixedView(creative.price, 3)}</Table.Cell>\n            <Table.Cell className='tar monoFont'>{roundFixedView(creative.income, 3)}</Table.Cell>\n            <Table.Cell className='tar monoFont' positive={creative.revenue > 0} negative={creative.revenue < 0}>{creative.revenue > 0 ? '+' : ''}{roundFixedView(creative.revenue, 3)}</Table.Cell>\n            <Table.Cell className='tar monoFont' style={{ cursor: 'pointer' }} positive={creative.roi > 0} negative={creative.roi < 0} onClick={() => onSelect('b-' + creative.id)}>{creative.revenue > 0 ? '+' : ''}{roundFixedView(creative.roi, 2)}</Table.Cell>\n          </Table.Row>\n        );\n      });\n    }\n    \n    $rows.push($row);\n  });\n\n  totalStats.ctr      = calcStatsCtr(totalStats.impressions, totalStats.clicks);\n  totalStats.cr       =  calcStatsCr(totalStats.clicks, totalStats.leads);\n  totalStats.ecpc     = calcStatsEcpc(totalStats.clicks, totalStats.price);\n  totalStats.ecpa     = calcStatsEcpa(totalStats.leads, totalStats.price);\n  totalStats.revenue  = calcStatsRevenue(totalStats.impressions, totalStats.price, totalStats.income);\n  totalStats.roi      = calcStatsRoi(totalStats.impressions, totalStats.leads, totalStats.price, totalStats.revenue);\n\n  return (\n    <>\n      {loadingError && <Segment inverted color='red' onClick={() => setLoadingError(null)}>\n        <Button onClick={() => setLoadingError(null)} floated='right' color='red' icon='close' size='tiny' style={{ marginTop: '-6px' }}/>\n        <p>{loadingError}</p>\n      </Segment>}\n      <Statistics stats={state.rowsCount > 0 && totalStats} />\n      <Segment loading={loading} style={{ padding: '0', border: '0' }}>\n        <Menu attached='top'>\n          <Menu.Item>\n            <DateInput\n              style={{ width: '133px' }}\n              disabled={loading}\n              placeholder='Date From'\n              dateFormat={DATE_FORMAT}\n              value={dates.from}\n              // icon={false}\n              iconPosition='left'\n              maxDate={dates.to}\n              onChange={(e, v) => setDates({ ...dates, from: v.value })}\n            />\n            <DateInput\n              style={{ width: '133px', marginLeft: '5px' }}\n              disabled={loading}\n              placeholder='Date To'\n              dateFormat={DATE_FORMAT}\n              value={dates.to}\n              // icon={false}\n              iconPosition='left'\n              minDate={dates.from}\n              maxDate={moment().format(DATE_FORMAT)}\n              onChange={(e, v) => setDates({ ...dates, to: v.value })}\n            />\n          </Menu.Item>\n          <Menu.Item>\n            <Dropdown placeholder='State' compact style={{ width: '120px' }}\n                      onChange={(e,v) => setFilterState(v.value)}\n                      value={filterState} selection options={[\n                        { key: 'all', text: 'All', value: 'all' },\n                        { key: 'active', text: 'Active', value: 'active' },\n                        { key: 'active-all', text: 'Active All', value: 'active-all' },\n                        { key: 'disabled', text: 'Disabled', value: 'disabled' },\n                        { key: 'pending', text: 'Pending', value: 'pending' },\n                      ]}/>\n          </Menu.Item>\n          <Menu.Menu position='right'>\n            <Menu.Item>\n              <Input placeholder='Search' style={{ width: '240px' }} value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)}/>\n            </Menu.Item>\n            <Menu.Item disabled={loading} onClick={() => loadData(true)}><Icon name='refresh' color='violet'/>Load Data</Menu.Item>\n            <Menu.Item disabled={loading} onClick={() => loadData()}><Icon name='refresh' color='blue'/>Load Stats</Menu.Item>\n          </Menu.Menu>\n        </Menu>\n        <Table compact striped sortable celled selectable attached='bottom'>\n          <Table.Header>\n            <Table.Row>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '50px' }} prop='active' title='Active'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '80px' }} prop='id' title='ID'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} prop='name' title='Name'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '90px' }} prop='impressions' title='Imprs'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '85px' }} prop='clicks' title='Clicks'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '85px' }} prop='leads' title='Leads'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '85px' }} prop='ctr' title='CTR %'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '85px' }} prop='cr' title='CR %'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '85px' }} prop='price' title='Price'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '85px' }} prop='income' title='Income'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '85px' }} prop='revenue' title='Revenue'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '85px' }} prop='roi' title='ROI %'/>\n            </Table.Row>\n          </Table.Header>\n          <Table.Body>{orderBy(rowsSortIndex, sortProp[0], !!sortProp[1] ? 'asc' : 'desc').map(item => $rows[item.campaignIndex])}</Table.Body>\n          <Table.Footer>\n            <Table.Row>\n              <Table.HeaderCell colSpan={3}>Count: {rowsSortIndex.length}</Table.HeaderCell>\n              <Table.HeaderCell className='tar monoFont'>{round(totalStats.impressions / 1000, 3).toFixed(3)}</Table.HeaderCell>\n              <Table.HeaderCell className='tar monoFont'>{totalStats.clicks}</Table.HeaderCell>\n              <Table.HeaderCell className='tar monoFont'>{totalStats.leads}</Table.HeaderCell>\n              <Table.HeaderCell className='tar monoFont'>{totalStats.ctr.toFixed(2)}</Table.HeaderCell>\n              <Table.HeaderCell className='tar monoFont'>{totalStats.cr.toFixed(2)}</Table.HeaderCell>\n              <Table.HeaderCell className='tar monoFont'>{round(totalStats.price,  3).toFixed(3)}</Table.HeaderCell>\n              <Table.HeaderCell className='tar monoFont'>{round(totalStats.income, 3).toFixed(3)}</Table.HeaderCell>\n              <Table.HeaderCell className='tar monoFont'>{(totalStats.revenue > 0 ? '+' : '') + round(totalStats.revenue, 3).toFixed(3)}</Table.HeaderCell>\n              <Table.HeaderCell className='tar monoFont'>{(totalStats.roi > 0 ? '+' : '') + round(totalStats.roi, 2)}%</Table.HeaderCell>\n            </Table.Row>\n          </Table.Footer>\n        </Table>\n      </Segment>\n    </>\n  );\n}\n\nexport default Campaigns;\n","// import Promise from 'bluebird';\nimport React, { useState, useEffect } from 'react';\nimport round from 'lodash/round';\nimport orderBy from 'lodash/orderBy';\nimport store from 'store';\nimport Moment from 'moment';\nimport { extendMoment } from 'moment-range';\nimport { Segment, Button, Table, Popup, Checkbox, Loader, Comment, Menu, Icon, Input, Dropdown, Flag } from 'semantic-ui-react';\nimport { DateInput } from 'semantic-ui-calendar-react';\nimport {\n  DATE_FORMAT,\n  roundFixedView, TableHeaderCell,\n  calcStatsCtr, calcStatsCr, calcStatsEcpc, calcStatsEcpa, calcStatsRevenue, calcStatsRoi,\n} from '../../utils';\nimport { dataIndex, statsIndex, saveStore } from '../../store';\nimport api  from '../../api';\nimport './style.scss';\nimport Statistics from '../Statistics';\nconst moment = extendMoment(Moment);\n\n\nfunction Banners(props = {}) {\n  // const now = Date.now();\n  const {\n    switchStamp,\n    auth,\n    dates, setDates,\n    searchQuery, setSearchQuery,\n  } = props;\n  const [state, setState] = useState({\n    rows: [],\n    rowsCount: -1,\n  });\n\n  const [loading, setLoading] = useState(false);\n  const [loadingError, setLoadingError] = useState(null);\n  const [selected, setSelected] = useState({});\n  const [opened, setOpened] = useState({});\n  const storeBannersFilter = store.get('tsapp.banners.filter') || {};\n  const [sortProp, setSortProp] = useState([storeBannersFilter['sortProp'] || 'cr', storeBannersFilter['sortValue'] || false]);\n  const [filterState, setFilterState] = useState('all');\n\n  function loadData(fullLoad = false) {\n    setLoading(true);\n    (!!fullLoad\n      ? Promise.all([\n          api.getCampaignsAndCreatives(auth.token),\n          api.getCreativesStats(auth.token, dates.from, dates.to),\n        ])\n      : api.getCreativesStats(auth.token, dates.from, dates.to)\n    )\n      .then(function () {\n        const creatives = Object.entries(dataIndex.creatives).map(([id, creative]) => creative);\n        if (creatives.length) {\n          // console.log(statsIndex);\n          saveStore();\n        }\n        setState({\n          rows: creatives,\n          rowsCount: creatives.length,\n        });\n        setLoading(false);\n      })\n      .catch(function (error) {\n        console.error(error);\n        setState({\n          rows: [],\n          rowsCount: -1,\n        });\n        const errMsg = error.toString();\n        setLoadingError(errMsg);\n        setLoading(false);\n      });\n  }\n\n  useEffect(() => {\n    if (loading || loadingError || !(auth && auth.token)) {\n      return null;\n    }\n    if (state.rowsCount < 0) {\n      loadData(switchStamp === 0);\n      return null;\n    }\n  });\n\n  function onSort(prop) {\n    setSortProp([prop, sortProp[0] === prop ? !sortProp[1] : false]);\n  }\n\n  function onSelect(id) {\n    if (selected[id]) {\n      delete selected[id];\n    } else {\n      selected[id] = true;\n    }\n    setSelected({\n      ...selected,\n    });\n  }\n\n  function onOpen(id) {\n    if (opened[id]) {\n      delete opened[id];\n    } else {\n      opened[id] = true;\n    }\n    setOpened({\n      ...opened,\n    });\n  }\n\n  function creativeRun(id) {\n    setLoading(true);\n    api.runCreative(auth.token, id)\n      .then(() => loadData(true))\n      .catch((error) => {\n        setLoadingError(error.toString());\n        setLoading(false);\n      })\n  }\n\n  function creativePause(id) {\n    setLoading(true);\n    api.pauseCreative(auth.token, id)\n      .then(() => loadData(true))\n      .catch((error) => {\n        setLoadingError(error.toString());\n        setLoading(false);\n      })\n  }\n\n  let totalStats = {\n    impressions:  0,\n    clicks:       0,\n    leads:        0,\n    price:        0,\n    income:       0,\n    ctr:          0,\n    cr:           0,\n    ecpc:         0,\n    ecpa:         0,\n    revenue:      0,\n    roi:          0,\n  };\n\n  const filterDates = Array.from(moment.range(moment(dates.from, DATE_FORMAT), moment(dates.to, DATE_FORMAT)).by('day')).map(d => d.format(DATE_FORMAT));\n  let rowsSortIndexCounter = 0;\n  const rowsSortIndex = [];\n  const rowsIndex = {};\n  const $rows = [];\n\n  state.rows.forEach((creative) => {\n    const creativeId = creative && creative.id;\n    if (!(creativeId && dataIndex.creatives[creativeId])) {\n      return null;\n    }\n    let campaign;\n    if (creative.campaign_id) {\n      campaign = dataIndex.campaigns[creative.campaign_id];\n    }\n    if (filterState !== 'all') {\n      switch(filterState) {\n        case 'active':\n          if (!creative.active || creative.pending || !campaign || !campaign.active) return null;\n          break;\n        case 'disabled':\n          if (creative.active || creative.pending || !(campaign && campaign.active)) return null;\n          break;\n        case 'pending':\n          if (!(creative && creative.pending)) return null;\n          break;\n        default:\n      }\n    }\n    if (searchQuery) {\n      const q = searchQuery.toLowerCase();\n      if (\n        !~((creative.id + '').indexOf(q)) &&\n        !~(creative.brandname.toLowerCase()).indexOf(q) &&\n        !~(creative.headline.toLowerCase()).indexOf(q) &&\n        (campaign ? !~(campaign.name.toLowerCase().indexOf(q)) : false)\n      ) {\n        return null;\n      }\n    }\n    \n    const bannerIndex = rowsSortIndexCounter++;\n    const imageUrl = api.getImageUrl(creative.image);\n    \n    creative.impressions = 0;\n    creative.clicks      = 0;\n    creative.leads       = 0;\n    creative.price       = 0;\n    creative.income      = 0;\n    creative.ctr         = 0;\n    creative.cr          = 0;\n    creative.ecpc        = 0;\n    creative.ecpa        = 0;\n    creative.revenue     = 0;\n    creative.roi         = 0;\n\n    filterDates.forEach(date => {\n      if (!(statsIndex[date] && statsIndex[date].creatives[creativeId])) {\n        return null;\n      }\n      const stat = statsIndex[date].creatives[creativeId];\n      creative.impressions += stat.impressions;\n      creative.clicks      += stat.clicks;\n      creative.leads       += stat.leads;\n      creative.price       += stat.amount;\n      creative.income      += stat.lead_price;\n    });\n    \n    creative.ctr     = calcStatsCtr(creative.impressions, creative.clicks);\n    creative.cr      = calcStatsCr(creative.clicks, creative.leads);\n    creative.ecpc    = calcStatsEcpc(creative.clicks, creative.price);\n    creative.ecpa    = calcStatsEcpa(creative.leads, creative.price);\n    creative.revenue = calcStatsRevenue(creative.impressions, creative.price, creative.income);\n    creative.roi     = calcStatsRoi(creative.impressions, creative.leads, creative.price, creative.revenue);\n    \n    if (rowsIndex[imageUrl]) {\n      rowsIndex[imageUrl].creatives[creativeId] = creative;\n    } else {\n      rowsIndex[imageUrl] = {\n        bannerIndex,\n        imageUrl,\n        creatives: {\n          [creativeId]: creative,\n        },\n      };\n    }\n  });\n\n  Object.keys(rowsIndex).forEach((imageUrl, bannerIndex) => {\n    const banner = rowsIndex[imageUrl];\n    \n    banner.impressions = 0;\n    banner.clicks      = 0;\n    banner.leads       = 0;\n    banner.price       = 0;\n    banner.income      = 0;\n    banner.ctr         = 0;\n    banner.cr          = 0;\n    banner.ecpc        = 0;\n    banner.ecpa        = 0;\n    banner.revenue     = 0;\n    banner.roi         = 0;\n\n    banner.creatives = Object.entries(banner.creatives).map(([id, creative]) => {\n      if (!selected['c-' + id]) {\n        banner.impressions += creative.impressions;\n        banner.clicks      += creative.clicks;\n        banner.leads       += creative.leads;\n        banner.price       += creative.price;\n        banner.income      += creative.income;\n      }\n      return creative;\n    });\n\n    banner.ctr     = calcStatsCtr(banner.impressions, banner.clicks);\n    banner.cr      = calcStatsCr(banner.clicks, banner.leads);\n    banner.ecpc    = calcStatsEcpc(banner.clicks, banner.price);\n    banner.ecpa    = calcStatsEcpa(banner.leads, banner.price);\n    banner.revenue = calcStatsRevenue(banner.impressions, banner.price, banner.income);\n    banner.roi     = calcStatsRoi(banner.impressions, banner.leads, banner.price, banner.revenue);\n\n    if (!selected['bi-' + imageUrl]) {\n      totalStats.impressions  += banner.impressions;\n      totalStats.clicks       += banner.clicks;\n      totalStats.leads        += banner.leads;\n      totalStats.price        += banner.price;\n      totalStats.income       += banner.income;\n    }\n\n    rowsSortIndex.push({\n      ...banner,\n      bannerIndex,\n    });\n\n    const $row = [\n      (\n        <Table.Row key={'bannerImage-' + banner.id} style={{ textDecoration: !!(selected['bi-' + imageUrl]) ? 'line-through' : '' }} active={!!opened['bi-' + imageUrl]}>\n          <Table.Cell colSpan={3} className='monoFont' style={{ cursor: 'pointer' }} onClick={() => onOpen('bi-' + imageUrl)}>\n            <Popup position='right center' flowing hoverable trigger={<Button color='blue' style={{ margin: '3px 5px 2px 2px', padding: '4px' }} size='tiny' icon='image' />}>\n              <Comment.Group>\n                <Comment>\n                  <Comment.Avatar href={imageUrl} title={imageUrl} alt={imageUrl} rel='noreferrer' target='_blank' src={imageUrl} />\n                </Comment>\n              </Comment.Group>\n            </Popup>\n            {'/' + imageUrl.split('/').slice(-5).join('/')}\n          </Table.Cell>\n          <Table.Cell className='tar monoFont'>{roundFixedView(banner.impressions / 1000, 3)}</Table.Cell>\n          <Table.Cell className='tar monoFont'>{roundFixedView(banner.clicks, 0)}</Table.Cell>\n          <Table.Cell className='tar monoFont'>{roundFixedView(banner.leads, 0)}</Table.Cell>\n          <Table.Cell className='tar monoFont'>{roundFixedView(banner.ctr, 2)}</Table.Cell>\n          <Table.Cell className='tar monoFont'>{roundFixedView(banner.cr, 2)}</Table.Cell>\n          <Table.Cell className='tar monoFont'>{roundFixedView(banner.price, 3)}</Table.Cell>\n          <Table.Cell className='tar monoFont'>{roundFixedView(banner.income, 3)}</Table.Cell>\n          <Table.Cell className='tar monoFont' positive={banner.revenue > 0} negative={banner.revenue < 0}>{banner.revenue > 0 ? '+' : ''}{roundFixedView(banner.revenue, 3)}</Table.Cell>\n          <Table.Cell className='tar monoFont' style={{ cursor: 'pointer' }} positive={banner.roi > 0} negative={banner.roi < 0} onClick={() => onSelect('bi-' + imageUrl)}>{banner.revenue > 0 ? '+' : ''}{roundFixedView(banner.roi, 2)}</Table.Cell>\n        </Table.Row>\n      )\n    ];\n\n    if (opened['bi-' + imageUrl]) {\n      orderBy(banner.creatives, sortProp[0], !!sortProp[1] ? 'asc' : 'desc').forEach(creative => {\n        const creativeUrls = creative.urls.filter(urlData => (urlData && urlData.status === 1) && urlData.id && urlData.url);\n        let campaign;\n        if (creative.campaign_id) {\n          campaign = dataIndex.campaigns[creative.campaign_id];\n        }\n        $row.push(\n          <Table.Row key={'creative-' + creative.id} warning={!creative.active || creative.pending || !campaign || !campaign.active} style={{ fontSize: '0.8em', textDecoration: !!(selected['c-' + creative.id]) ? 'line-through' : '' }}>\n            <Table.Cell className='tac'>\n              {(creative.pending) ? <Loader active inline size='mini'/>\n                : ((creative.rejected) ? <Button color='red' style={{ margin: '0 5px 0 0', padding: '2px' }} size='tiny' icon='warning'/>\n                  : <Checkbox slider disabled={!(campaign && campaign.active)}  checked={!!(campaign && campaign.active && creative.active)} onClick={() => (campaign && campaign.active && creative.active) ? creativePause(creative.id) : creativeRun(creative.id) } />\n                )\n              }\n            </Table.Cell>\n            <Table.Cell className='monoFont'>{''}&thinsp;{creative.id}</Table.Cell>\n            <Table.Cell className='monoFont'>\n              {(campaign && campaign.countries && campaign.countries.length > 0) && campaign.countries.map(countryCode => (<Flag key={'countryCode-' + countryCode} name={countryCode.toLowerCase()} />))}\n              {campaign && <b>{campaign.name}</b>}&nbsp;\n              <Popup position='right center' flowing hoverable trigger={<Button color='blue' style={{ margin: '0 5px 0 0', padding: '2px' }} size='tiny' icon='info'/>}>\n                <Comment.Group>\n                  <Comment>\n                    <Comment.Content>\n                      <span className='author'>{creative.brandname}</span>\n                      <Comment.Text style={{ margin: '0', padding: '0' }}>\n                        <p style={{ marginBottom: '3px' }}>{creative.headline}</p>\n                        {creativeUrls.length > 0 && (\n                          <ul style={{ margin: '0', padding: '0' }}>\n                            {creativeUrls.map(urlData => (\n                              <li key={urlData} style={{ listStyle: 'none' }}>\n                                <a href={urlData.url} title={urlData.url} alt={urlData.url} rel='noreferrer' target='_blank'>{urlData.id}</a>\n                              </li>\n                            ))}\n                          </ul>\n                        )}\n                      </Comment.Text>\n                    </Comment.Content>\n                  </Comment>\n                </Comment.Group>\n              </Popup>\n              <i>{creative.brandname}</i>\n            </Table.Cell>\n            <Table.Cell className='tar monoFont'>{roundFixedView(creative.impressions / 1000, 3)}</Table.Cell>\n            <Table.Cell className='tar monoFont'>{roundFixedView(creative.clicks, 0)}</Table.Cell>\n            <Table.Cell className='tar monoFont'>{roundFixedView(creative.leads, 0)}</Table.Cell>\n            <Table.Cell className='tar monoFont'>{roundFixedView(creative.ctr, 2)}</Table.Cell>\n            <Table.Cell className='tar monoFont'>{roundFixedView(creative.cr, 2)}</Table.Cell>\n            <Table.Cell className='tar monoFont'>{roundFixedView(creative.price, 3)}</Table.Cell>\n            <Table.Cell className='tar monoFont'>{roundFixedView(creative.income, 3)}</Table.Cell>\n            <Table.Cell className='tar monoFont' positive={creative.revenue > 0} negative={creative.revenue < 0}>{creative.revenue > 0 ? '+' : ''}{roundFixedView(creative.revenue, 3)}</Table.Cell>\n            <Table.Cell className='tar monoFont' style={{ cursor: 'pointer' }} positive={creative.roi > 0} negative={creative.roi < 0} onClick={() => onSelect('c-' + creative.id)}>{creative.revenue > 0 ? '+' : ''}{roundFixedView(creative.roi, 2)}</Table.Cell>\n          </Table.Row>\n        );\n      });\n    }\n\n    $rows.push($row);\n  });\n\n  totalStats.ctr      = calcStatsCtr(totalStats.impressions, totalStats.clicks);\n  totalStats.cr       = calcStatsCtr(totalStats.clicks, totalStats.leads);\n  totalStats.ecpc     = calcStatsEcpc(totalStats.clicks, totalStats.price);\n  totalStats.ecpa     = calcStatsEcpa(totalStats.leads, totalStats.price);\n  totalStats.revenue  = calcStatsRevenue(totalStats.impressions, totalStats.price, totalStats.income);\n  totalStats.roi      = calcStatsRoi(totalStats.impressions, totalStats.leads, totalStats.price, totalStats.revenue);\n\n  return (\n    <>\n      {loadingError && <Segment inverted color='red' onClick={() => setLoadingError(null)}>\n        <Button onClick={() => setLoadingError(null)} floated='right' color='red' icon='close' size='tiny' style={{ marginTop: '-6px' }}/>\n        <p>{loadingError}</p>\n      </Segment>}\n      <Statistics stats={state.rowsCount > 0 && totalStats} />\n      <Segment loading={loading} style={{ padding: '0', border: '0' }}>\n        <Menu attached='top'>\n          <Menu.Item>\n            <DateInput\n              style={{ width: '133px' }}\n              disabled={loading}\n              placeholder='Date From'\n              dateFormat={DATE_FORMAT}\n              value={dates.from}\n              // icon={false}\n              iconPosition='left'\n              maxDate={dates.to}\n              onChange={(e, v) => setDates({ ...dates, from: v.value })}\n            />\n            <DateInput\n              style={{ width: '133px', marginLeft: '5px' }}\n              disabled={loading}\n              placeholder='Date To'\n              dateFormat={DATE_FORMAT}\n              value={dates.to}\n              // icon={false}\n              iconPosition='left'\n              minDate={dates.from}\n              maxDate={moment().format(DATE_FORMAT)}\n              onChange={(e, v) => setDates({ ...dates, to: v.value })}\n            />\n          </Menu.Item>\n          <Menu.Item>\n            <Dropdown placeholder='State' compact style={{ width: '120px' }}\n                      onChange={(e,v) => setFilterState(v.value)}\n                      value={filterState} selection options={[\n                        { key: 'all', text: 'All', value: 'all' },\n                        { key: 'active', text: 'Active', value: 'active' },\n                        { key: 'disabled', text: 'Disabled', value: 'disabled' },\n                        { key: 'pending', text: 'Pending', value: 'pending' },\n                      ]}/>\n          </Menu.Item>\n          <Menu.Menu position='right'>\n            <Menu.Item>\n              <Input placeholder='Search' style={{ width: '240px' }} value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)}/>\n            </Menu.Item>\n            <Menu.Item disabled={loading} onClick={() => loadData(true)}><Icon name='refresh' color='violet'/>Load Data</Menu.Item>\n            <Menu.Item disabled={loading} onClick={() => loadData()}><Icon name='refresh' color='blue'/>Load Stats</Menu.Item>\n          </Menu.Menu>\n        </Menu>\n        <Table compact striped sortable celled selectable attached='bottom'>\n          <Table.Header>\n            <Table.Row>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '65px' }} prop='active' title='Active'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '80px' }} prop='id' title='ID'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} prop='name' title='Name'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '90px' }} prop='impressions' title='Imprs'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '85px' }} prop='clicks' title='Clicks'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '85px' }} prop='leads' title='Leads'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '85px' }} prop='ctr' title='CTR %'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '85px' }} prop='cr' title='CR %'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '85px' }} prop='price' title='Price'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '85px' }} prop='income' title='Income'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '85px' }} prop='revenue' title='Revenue'/>\n              <TableHeaderCell sort={sortProp} onSort={onSort} style={{ width: '85px' }} prop='roi' title='ROI %'/>\n            </Table.Row> \n          </Table.Header>\n          <Table.Body>{orderBy(rowsSortIndex, sortProp[0], !!sortProp[1] ? 'asc' : 'desc').map(item => $rows[item.bannerIndex])}</Table.Body>\n          <Table.Footer>\n            <Table.Row>\n              <Table.HeaderCell colSpan={3}>Count: {rowsSortIndex.length}</Table.HeaderCell>\n              <Table.HeaderCell className='tar monoFont'>{round(totalStats.impressions / 1000, 3).toFixed(3)}</Table.HeaderCell>\n              <Table.HeaderCell className='tar monoFont'>{totalStats.clicks}</Table.HeaderCell>\n              <Table.HeaderCell className='tar monoFont'>{totalStats.leads}</Table.HeaderCell>\n              <Table.HeaderCell className='tar monoFont'>{totalStats.ctr.toFixed(2)}</Table.HeaderCell>\n              <Table.HeaderCell className='tar monoFont'>{totalStats.cr.toFixed(2)}</Table.HeaderCell>\n              <Table.HeaderCell className='tar monoFont'>{round(totalStats.price,  3).toFixed(3)}</Table.HeaderCell>\n              <Table.HeaderCell className='tar monoFont'>{round(totalStats.income, 3).toFixed(3)}</Table.HeaderCell>\n              <Table.HeaderCell className='tar monoFont'>{(totalStats.revenue > 0 ? '+' : '') + round(totalStats.revenue, 3).toFixed(3)}</Table.HeaderCell>\n              <Table.HeaderCell className='tar monoFont'>{(totalStats.roi > 0 ? '+' : '') + round(totalStats.roi, 2)}%</Table.HeaderCell>\n            </Table.Row>\n          </Table.Footer>\n        </Table>\n      </Segment>\n    </>\n  );\n}\n\nexport default Banners;\n","import React, { useState, useEffect } from 'react';\nimport round from 'lodash/round';\nimport orderBy from 'lodash/orderBy';\nimport store from 'store';\nimport Moment from 'moment';\nimport { extendMoment } from 'moment-range';\nimport { Segment, Button, Table, Popup, Checkbox, Loader, Comment, Menu, Icon, Input, Dropdown, Flag } from 'semantic-ui-react';\nimport { DateInput } from 'semantic-ui-calendar-react';\nimport { dataIndex, saveStore } from '../../store';\nimport api  from '../../api';\nimport {\n  DATE_FORMAT,\n  roundFixedView, TableHeaderCell,\n  calcStatsCtr, calcStatsCr, calcStatsEcpc, calcStatsEcpa, calcStatsRevenue, calcStatsRoi,\n} from '../../utils';\nimport './style.scss';\nconst moment = extendMoment(Moment);\n\n\nfunction Conversions(props) {\n  const {\n    switchStamp,\n    auth,\n    dates, setDates,\n    searchQuery, setSearchQuery,\n  } = props;\n  const [state, setState] = useState({\n    rows: [],\n    rowsCount: -1,\n  });\n\n  const [loading, setLoading] = useState(false);\n  const [loadingError, setLoadingError] = useState(null);\n  const storeConversionsFilter = store.get('tsapp.conversions.filter') || {};\n  const [sortProp, setSortProp] = useState([storeConversionsFilter['sortProp'] || 'cr', storeConversionsFilter['sortValue'] || false]);\n  const [filterState, setFilterState] = useState('all');\n\n  function loadData(fullLoad = false) {\n    setLoading(true);\n    (!!fullLoad\n      ? Promise.all([\n          api.getCampaignsAndCreatives(auth.token),\n          api.getConversions(auth.apiKey, 142387),\n        ])\n      : api.getConversions(auth.apiKey, 142387)\n    )\n      .then(function () {\n        const urls = Object.entries(dataIndex.urls).map(([id, url]) => url);\n        if (urls.length) {\n          // console.log(statsIndex);\n          saveStore();\n        }\n        setState({\n          rows: urls,\n          rowsCount: urls.length,\n        });\n        setLoading(false);\n      })\n      .catch(function (error) {\n        console.error(error);\n        setState({\n          rows: [],\n          rowsCount: -1,\n        });\n        const errMsg = error.toString();\n        setLoadingError(errMsg);\n        setLoading(false);\n      });\n  }\n\n  useEffect(() => {\n    if (loading || loadingError || !(auth && auth.token && auth.apiKey)) {\n      return null;\n    }\n    if (state.rowsCount < 0) {\n      loadData(switchStamp === 0);\n      return null;\n    }\n  });\n\n  function onSort(prop) {\n    setSortProp([prop, sortProp[0] === prop ? !sortProp[1] : false]);\n  }\n\n  const rowsSortIndex = [];\n  const $rows = [];\n\n  state.rows.forEach(conversion => {\n    console.log('conversion', conversion);\n  });\n\n  return (\n    <>\n      {loadingError && <Segment inverted color='red' onClick={() => setLoadingError(null)}>\n        <Button onClick={() => setLoadingError(null)} floated='right' color='red' icon='close' size='tiny' style={{ marginTop: '-6px' }}/>\n        <p>{loadingError}</p>\n      </Segment>}\n      <Segment loading={loading} style={{ padding: '0', border: '0' }}>\n        <Menu attached='top'>\n          <Menu.Item>\n            <DateInput\n              style={{ width: '133px' }}\n              disabled={loading}\n              placeholder='Date From'\n              dateFormat={DATE_FORMAT}\n              value={dates.from}\n              // icon={false}\n              iconPosition='left'\n              maxDate={dates.to}\n              onChange={(e, v) => setDates({ ...dates, from: v.value })}\n            />\n            <DateInput\n              style={{ width: '133px', marginLeft: '5px' }}\n              disabled={loading}\n              placeholder='Date To'\n              dateFormat={DATE_FORMAT}\n              value={dates.to}\n              // icon={false}\n              iconPosition='left'\n              minDate={dates.from}\n              maxDate={moment().format(DATE_FORMAT)}\n              onChange={(e, v) => setDates({ ...dates, to: v.value })}\n            />\n          </Menu.Item>\n          <Menu.Item>\n            <Dropdown placeholder='State' compact style={{ width: '120px' }}\n                      onChange={(e,v) => setFilterState(v.value)}\n                      value={filterState} selection options={[\n                        { key: 'all', text: 'All', value: 'all' },\n                        { key: 'active', text: 'Active', value: 'active' },\n                        { key: 'disabled', text: 'Disabled', value: 'disabled' },\n                        { key: 'pending', text: 'Pending', value: 'pending' },\n                      ]}/>\n          </Menu.Item>\n          <Menu.Menu position='right'>\n            <Menu.Item>\n              <Input placeholder='Search' style={{ width: '240px' }} value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)}/>\n            </Menu.Item>\n            <Menu.Item disabled={loading} onClick={() => loadData(true)}><Icon name='refresh' color='violet'/>Load Data</Menu.Item>\n            <Menu.Item disabled={loading} onClick={() => loadData()}><Icon name='refresh' color='blue'/>Load Stats</Menu.Item>\n          </Menu.Menu>\n        </Menu>\n        <Table compact striped sortable celled selectable attached='bottom'>\n          <Table.Header>\n            <Table.Row>\n              <TableHeaderCell sort={sortProp} onSort={onSort} prop='id' title='ID'/>\n            </Table.Row> \n          </Table.Header>\n          <Table.Body>{orderBy(rowsSortIndex, sortProp[0], !!sortProp[1] ? 'asc' : 'desc').map(item => $rows[item.bannerIndex])}</Table.Body>\n          <Table.Footer>\n            <Table.Row>\n              <Table.HeaderCell>Count: {rowsSortIndex.length}</Table.HeaderCell>\n            </Table.Row>\n          </Table.Footer>\n        </Table>\n      </Segment>\n    </>\n  );\n}\n\nexport default Conversions;\n","// import Promise from 'bluebird';\nimport React, { useState, useEffect } from 'react';\nimport round from 'lodash/round';\nimport store from 'store';\nimport Moment from 'moment';\nimport { extendMoment } from 'moment-range';\nimport { Container, Segment, Button, Menu, Checkbox, Modal, Form, Input, Icon } from 'semantic-ui-react';\nimport { DATE_FORMAT }  from '../../utils';\nimport api  from '../../api';\nimport './style.scss';\nimport Campaigns from '../Campaigns';\nimport Banners from '../Banners';\nimport Conversions from '../Conversions';\nconst moment = extendMoment(Moment);\n\n\nfunction App() {\n  const now = Date.now();\n  const [loading, setLoading] = useState(false);\n  const [loadingError, setLoadingError] = useState(null);\n  const [authError, setAuthError] = useState(null);\n  const [authModal, setAuthModal] = useState(false);\n  const [useLocalStore, setUseLocalStore] = useState(true);\n  const [switchStamp, setViewSwitchStamp] = useState(0);\n  const [viewSelect, setViewSelect] = useState('campaigns');\n  const [auth, setAuth] = useState(store.get('tsapp.auth') || {});\n  const [dates, setDates] = useState({\n    from: moment().format(DATE_FORMAT),\n    to:   moment().format(DATE_FORMAT),\n  });\n  const [searchQuery, setSearchQuery] = useState('');\n\n  function onAuth() {\n    if (!(auth.clientId && auth.clientSecret && auth.login && auth.password)) {\n      setAuth({\n        ...auth,\n        tokenRefresh: '',\n      });\n      return null;\n    }\n    setLoading(true);\n    api.auth(auth.clientId, auth.clientSecret, auth.login, auth.password)\n      .then((data) => {\n        const authData = { ...auth, ...data };\n        if (useLocalStore) {\n          store.set('tsapp.auth', authData);\n        }\n        setAuth(authData);\n        if (authData.token) {\n          setAuthModal(false);\n        }\n        setLoading(false);\n      })\n      .catch(function (error) {\n        setAuth({\n          ...auth,\n          tokenRefresh: '',\n        });\n        setAuthError(error.toString());\n        setLoading(false);\n      });\n  }\n\n  function onAuthRefresh() {\n    if (!(auth.clientId && auth.clientSecret && auth.tokenRefresh)) {\n      return null;\n    }\n    setLoading(true);\n    api.authRefresh(auth.clientId, auth.clientSecret, auth.tokenRefresh)\n      .then((data) => {\n        const authData = { ...auth, ...data };\n        if (useLocalStore) {\n          store.set('tsapp.auth', authData);\n        }\n        setAuth(authData);\n        setLoading(false);\n      })\n      .catch(function (error) {\n        setAuth({\n          ...auth,\n          token:        '',\n          tokenRefresh: '',\n          ttl:          0,\n        });\n        setAuthError(error.toString());\n        setLoading(false);\n      });\n  }\n\n  useEffect(() => {\n    if (loading || authError || loadingError) {\n      return null;\n    }\n    if (!auth.token) {\n      if (!authModal) {\n        setAuthModal(true);\n      }\n      return null;\n    }\n  }, [loading,loadingError, auth, authError, authModal]);\n\n  function inViewSelect(view) {\n    setViewSwitchStamp(now);\n    setViewSelect(view);\n  }\n\n  const tokenTtlSeconds = round((auth.ttl - now) / 1000);\n  const tokenDuration = moment.duration(tokenTtlSeconds % 3600 > 0 ? tokenTtlSeconds : (tokenTtlSeconds - 1), 'seconds');\n  const tokenDurationMinutes = tokenDuration.get('minutes');\n  const tokenDurationText = tokenDuration.humanize(true);\n\n  return (\n    <>\n      <Menu fluid attached='top' inverted style={{ borderRadius: '0' }}>\n        <Menu.Item header>TSapp</Menu.Item>\n        <Menu.Item><Icon color={tokenDurationMinutes >= 30 ? 'green' : (tokenDurationMinutes >= 8 ? 'orange' : 'red') } name='key'/>expires {tokenDurationText}</Menu.Item>\n        {(auth.clientId && auth.clientSecret && auth.tokenRefresh) && <Menu.Item disabled={loading} onClick={() => onAuthRefresh()}><Icon name='refresh' color={tokenDurationMinutes >= 8 ? null : 'green'}/>Refresh token</Menu.Item>}\n        <Menu.Menu position='right'>\n          <Menu.Item disabled={loading} active={viewSelect === 'campaigns'} onClick={() => inViewSelect('campaigns')}><Icon name='suitcase'/>Campaigns</Menu.Item>\n          <Menu.Item disabled={loading} active={viewSelect === 'banners'} onClick={() => inViewSelect('banners')}><Icon name='picture'/>Banners</Menu.Item>\n          <Menu.Item disabled={loading} active={viewSelect === 'conversions'} onClick={() => inViewSelect('conversions')}><Icon name='dollar'/>Conversions</Menu.Item>\n        </Menu.Menu>\n      </Menu>\n\n      <Container className='App' fluid style={{ padding: '25px 25px 55px 25px' }}>\n\n        {loadingError && <Segment inverted color='red' onClick={() => setLoadingError(null)}>\n          <Button onClick={() => setLoadingError(null)} floated='right' color='red' icon='close' size='tiny' style={{ marginTop: '-6px' }}/>\n          <p>{loadingError}</p>\n        </Segment>}\n\n        {(viewSelect === 'campaigns') && (\n          <Campaigns switchStamp={switchStamp} auth={auth} dates={dates} setDates={setDates} searchQuery={searchQuery} setSearchQuery={setSearchQuery} />\n        )}\n        {(viewSelect === 'banners') && (\n          <Banners switchStamp={switchStamp} auth={auth} dates={dates} setDates={setDates} searchQuery={searchQuery} setSearchQuery={setSearchQuery}/>\n        )}\n        {(viewSelect === 'conversions') && (\n          <Conversions switchStamp={switchStamp} auth={auth} dates={dates} setDates={setDates} searchQuery={searchQuery} setSearchQuery={setSearchQuery}/>\n        )}\n\n      </Container>\n\n      <Modal open={authModal}>\n        <Modal.Header>Auth</Modal.Header>\n        <Modal.Content>\n          {authError && <Segment inverted color='red' onClick={() => setAuthError(null)}>\n            <Button onClick={() => setAuthError(null)} floated='right' color='red' icon='close' size='tiny' style={{ marginTop: '-6px' }}/>\n            <p>{authError}</p>\n          </Segment>}\n          <Form>\n            <Form.Field>\n              <label>TS client ID</label>\n              <Input placeholder='TS client ID' value={auth.clientId || ''} onChange={v => setAuth({ ...auth, clientId: v.target.value  })} />\n            </Form.Field>\n            <Form.Field>\n              <label>TS client Secret</label>\n              <Input placeholder='TS client Secret' value={auth.clientSecret || ''} onChange={v => setAuth({ ...auth, clientSecret: v.target.value  })} />\n            </Form.Field>\n            <Form.Field>\n              <label>CD api Key</label>\n              <Input placeholder='CD api Key' value={auth.apiKey || ''} onChange={v => setAuth({ ...auth, apiKey: v.target.value  })} />\n            </Form.Field>\n            <Form.Field>\n              <label>Login</label>\n              <Input placeholder='Login' value={auth.login || ''} onChange={v => setAuth({ ...auth, login: v.target.value  })} />\n            </Form.Field>\n            <Form.Field>\n              <label>Password</label>\n              <Input type='password' placeholder='Password' value={auth.password || ''} onChange={v => setAuth({ ...auth, password: v.target.value  })} />\n            </Form.Field>\n            <Form.Field>\n              <Checkbox checked={!!useLocalStore} onChange={() => setUseLocalStore(!useLocalStore)} label='Save credentials in local storage' />\n            </Form.Field>\n          </Form>\n        </Modal.Content>\n        <Modal.Actions>\n          <Button type='submit' color='green' onClick={() => onAuth()}>Auth</Button>\n        </Modal.Actions>\n      </Modal>\n    </>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './index.scss';\n\nimport App from './components/App';\nimport reportWebVitals from './reportWebVitals';\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}